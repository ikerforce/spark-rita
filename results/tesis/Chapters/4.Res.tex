\chapter{Resultados}
\label{chapter:resultados}

\noindent En este capítulo se analizan los resultados del experimento en ambos ambientes. 

Para cada proceso se registró: el tiempo total de ejecución, el tiempo de escritura, el tiempo entre el envío del comando y el tiempo de inicio de la ejecución y el porcentaje de ejecuciones completadas de manera exitosa. Esta información se acompañó del ambiente y tamaño de la muestra para ver cómo estas métricas evolucionan al cambiar de ambiente y de número de datos a procesar.

Durante esta investigación buscamos conocer la rapidez con la que las herramientas ejecutan los procesos pero también cómo cambia esta relación cuando modificamos el número de datos o el ambiente de ejecución y así tener una idea de su capacidad de escalamiento. También buscamos ver la consistencia del tiempo de ejecución de los procesos y conocer qué tan robusto es cada \textit{framework} para determinar si uno es más estable que el otro para completar las tareas. Por tal motivo, las secciones \ref{section:resultados-ambiente-local} y \ref{section:resultados-ambiente-nube} se dividen en tres partes: en la primera, se analizan los resultados de cada muestra de forma independiente, en la segunda, se aborda el cambio del comportamiento de cada proceso a través de las diferentes muestras y, en la última parte, se resumen las conclusiones obtenidas a partir de las dos anteriores. 
En la primera sección, nos centraremos en las siguientes características y capacidades de cada \textit{framework} y después se hará una conclusión general para cada muestra de datos. A continuación se listan los rubros que se evaluarán y en qué consistirá el análisis para determinar el mejor desempeño de una herramienta frente a la otra.

\begin{itemize}
	
	\item \textbf{Robustez.} Analizar qué tan resistentes a fallos son los procesos y su estabilidad para terminar las tareas asignadas. La principal métrica para evaluar esto será el porcentaje de ejecuciones completadas exitosamente en cada proceso.
	
	\item \textbf{Variación.} Medir la variación del tiempo de ejecución de cada proceso en cada \textit{framework} y establecer cuál de los dos es más consistente en el tiempo de ejecución. Para este análisis se utilizarán la desviación estándar del tiempo de duración y el coeficiente de variación como métricas principales.
	
	\item \textbf{Inicio de la ejecución.} Comparar el tiempo que le toma a cada proceso ejecutar la primera línea de código. Esto dará una idea de qué tanto tiempo le toma a cada herramienta la asignación de recursos y configuraciones previas a la ejecución del código. La principal métrica para comparar será el tiempo registrado entre la ejecución del comando que inicia el proceso y la primera acción ejecutada dentro del proceso. Es importante notar que el tiempo de inicio de la ejecución fue calculado de forma independiente al tiempo de ejecución por lo que no está incluido dentro del mismo.
	
	\item \textbf{Escritura.} Determinar cuál \textit{framework} es más rápido para escribir el resultado a cada destino. Se analizarán de forma separada los procesos que tienen como destino final una base de datos \textit{MySQL} y los que escriben a archivos \texttt{parquet} como destino final. Se optó por definir estos destinos ya que el primero es comúnmente utilizado para aplicaciones de inteligencia de negocio o plataformas de monitoreo mientras que la segunda es la recomendada por ambos \textit{frameworks} para tareas de escritura y lectura por lo que también es común en diversas aplicaciones de \textit{Big Data}. La principal métrica será el tiempo de escritura registrado por cada proceso. Los procesos que escriben a archivos \texttt{parquet} son: \texttt{demoras\_aeropuerto\_destino}, \texttt{demoras\_aerolinea} y \texttt{demoras\_ruta\_aeropuerto}, mientras que los que escriben a \textit{MySQL} son: \texttt{demoras\_aeropuerto\_origen}, \texttt{demoras\_ruta\_mktid}, \texttt{flota} y \texttt{dijkstra}. Sin embargo, en caso del último proceso, el resultado escrito raramente es mayor a 5 registros por lo que no será considerado en el apartado de escritura. Además, el proceso \texttt{elimina\_nulos} imprime su resultado en consola por lo que tampoco será considerado para el análisis de tiempo de escritura.
	
	\item \textbf{Capacidad de cómputo.} Establecer qué herramienta tiene un tiempo menor de procesamiento de los datos. El tiempo de cómputo engloba el tiempo de lectura de la fuente de datos, el tiempo de cálculo de resultados y la transferencia de datos necesaria. Este tiempo no incluye el tiempo transcurrido para las tareas de escritura o el tiempo de inicio de la ejecución. La principal métrica será el tiempo total transcurrido, quitando el tiempo de escritura.
	
	\item \textbf{Duración.} Contrastar el desempeño de una herramienta frente a la otra en el tiempo total de ejecución de cada proceso. La métrica para comparar los \textit{frameworks} será el tiempo de ejecución registrado en cada proceso y las razones entre los mismos calculadas de la siguiente manera: $\frac{\texttt{tiempo\_de\_ejecucion\_dask}}{\texttt{tiempo\_de\_ejecucion\_spark}}$ y $\frac{\texttt{tiempo\_de\_ejecucion\_spark}}{\texttt{tiempo\_de\_ejecucion\_dask}}$.
\end{itemize}

En la segunda sección, el énfasis será en el tiempo de escritura de acuerdo a las diferentes muestras y en el tiempo de ejecución total de cada proceso.

\section{Ambiente local}
\label{section:resultados-ambiente-local}

Para empezar revisaremos los resultados de cada \textit{framework} en los distintos procesos y a través de las diferentes muestras de datos al ejecutarlos en el ambiente local. Después de una revisión individual de cada muestra de datos vamos a pasar a un análisis global en el que analizaremos la capacidad de escalamiento de la herramienta en una computadora local. Por último revisaremos las conclusiones generales obtenidas.

\subsection{Ejecución local con 10,000 registros}
\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 10,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (4.678,demoras\_aerolinea)
  						(4.578,demoras\_aeropuerto\_destino)
  						(5.406,demoras\_aeropuerto\_origen)
  						(4.881,demoras\_ruta\_aeropuerto)
  						(5.901,demoras\_ruta\_mktid)
  						(16.957,dijkstra)
  						(2.993,elimina\_nulos)
  						(6.12,flota)};  
  
  \addplot[fill=orange] coordinates { (2.024,demoras\_aerolinea)
  						(1.939,demoras\_aeropuerto\_destino)
  						(3.386,demoras\_aeropuerto\_origen)
  						(3.291,demoras\_ruta\_aeropuerto)
  						(4.991,demoras\_ruta\_mktid)
  						(3.488,dijkstra)
  						(1.395,elimina\_nulos)
  						(3.029,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos con 10,000 registros en el ambiente local.}
\label{barras:duracion10K}
\end{figure}
\end{center}

Las conclusiones más relevantes sobre esta muestra de datos son las siguientes:

\begin{itemize}
	
	\item \textbf{Robustez.} Con la muestra de datos más pequeña, ambos \textit{frameworks} lograron completar todos los procesos sin fallas, por lo que su estabilidad es comparable.
	
	\item \textbf{Variación.} De acuerdo a los resultados expuestos en la tabla \ref{table:duracion10K}, en la mayoría de los procesos \textit{Dask} registró un coeficiente de variación mayor que \textit{Spark}. No obstante, hay que considerar que sus tiempos de ejecución fueron menores y casi nunca pasaron de 5 segundos de duración, por lo que un coeficiente de variación más grande es razonable. La única excepción a lo anterior fue el proceso \texttt{dijkstra} en el que \textit{Spark} tuvo mayor coeficiente de variación a pesar de tener mayor tiempo de ejecución promedio. En este proceso ambos \textit{frameworks} registraron la mayor variación debido en gran parte a que este proceso calcula una ruta aleatoria en cada ejecución. Además, es importante notar que la mayoría de los coeficientes de variación se mantuvieron por debajo de 0.03 con la excepción de \texttt{dijsktra} y los procesos \texttt{demoras\_ruta\_mktid}, \texttt{demoras\_ruta\_aeropuerto} y \texttt{flota} de \textit{Dask}, de los cuales dos tuvieron un coeficiente mayor a 0.4.
	
	\item \textbf{Inicio de la ejecución.} Los resultados registrados en la tabla \ref{table:otros10K} muestran que una de las diferencias más evidentes entre ambos \textit{frameworks} es el tiempo que tardan en iniciar la ejecución. En el caso de \textit{Spark} este es de alrededor de un segundo, mientras que \textit{Dask} registró un promedio menor a una centésima de segundo en casi todos los casos (con la excepción de \texttt{dijkstra} que es cercano a medio segundo y requiere leer parámetros adicionales antes de iniciar la ejecución).
	
	\item \textbf{Escritura.} \textit{Dask} registró un tiempo mucho menor en la escritura a archivos \texttt{parquet} que \textit{Spark} en todos los casos, donde la diferencia fue de poco menos de un segundo en los tres procesos que tienen como destino final este tipo de archivo. Por otro lado, cuando el destino de escritura es una base de datos \textit{MySQL}, \textit{Dask} también registró un mejor desempeño aunque la diferencia no es tan evidente como en el caso de archivos \texttt{parquet} ya que es de tan solo unas décimas de segundo. Esta información está expuesta en la tabla \ref{table:write10K}.
	
	\item \textbf{Capacidad de cómputo.} La evidencia presentada en la tabla \ref{table:otros10K} permite ver que durante estas ejecuciones, \textit{Dask} registró un tiempo de  cómputo menor en todos los procesos. La diferencia más evidente se presentó en el proceso \texttt{dijkstra} en el que \textit{Spark} fue casi 5 veces más tardado. Esto sucede debido a que el algoritmo es iterativo y \textit{Dask} tiene una mayor facilidad para utilizar los resultados previos, ya que el resultado de cada iteración es un \textit{DataFrame} de \textit{Pandas} almacenado en memoria. \textit{Spark}, por el contrario, tiene como comportamiento predeterminado descartar la información de la ejecución anterior y volver a ejecutar todo el proceso, lo que obliga a utilizar la función \texttt{checkpoint} que escribe los resultados intermedios a disco, lo que resulta costoso. Respecto a los otros procesos, a excepción de \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid} que involucran la creación de una nueva llave y donde la diferencia en los tiempos de ejecución fue menor a décimas de segundo, \textit{Spark} registró tiempos de casi el doble que los registrados por \textit{Dask}.
	
	\item \textbf{Duración.} Al considerar el tiempo de ejecución total promedio (resumido en el gráfico \ref{barras:duracion10K}), podemos ver que \textit{Dask} también tuvo un mejor desempeño en todos los procesos, especialmente en el proceso \texttt{dijkstra} que fue más de 5 veces más rápido en \textit{Dask}. Por otra parte, los procesos \texttt{demoras\_aerolinea}, \texttt{demoras\_aeropuerto\_destino} y \texttt{demoras\_aeropuerto\_origen} que involucran agregaciones como promedios, obtención del máximo y mínimo y conteos utilizando múltiples llaves para agrupar, tuvieron un tiempo de ejecución al menos 1.5 veces mayor en \textit{Spark}. Además, esta diferencia fue mayor cuando estos procesos tuvieron archivos \texttt{parquet} como destino. Adicionalmente, los procesos que realizan tareas de preparación de datos como los procesos \texttt{elimina\_nulos} y \texttt{flota} (cuyas tareas son borrado de registros con nulos y eliminación de duplicados respectivamente) también tuvieron un tiempo de ejecución al menos dos veces mayor en \textit{Spark}. Por último, los procesos que involucran agregaciones como promedio y desviación estándar usando una llave nueva generada a partir de columnas existentes (\texttt{demoras\_ruta\_mktid} y \texttt{demoras\_ruta\_aeropuerto}) tuvieron la menor diferencia de tiempo, siendo entre 1 y 1.5 veces mayor en \textit{Spark} que en \textit{Dask}.  
	
\end{itemize}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 100 & 2.024 & 0.048 & 0.024 & 0.433 & 2.311 \\ % \hline
        demoras\_aerolinea & spark & 100 & 4.678 & 0.065 & 0.014 & 0.433 & 2.311 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 100 & 1.939 & 0.043 & 0.022 & 0.424 & 2.361 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 100 & 4.578 & 0.064 & 0.014 & 0.424 & 2.361 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 100 & 3.386 & 0.095 & 0.028 & 0.626 & 1.597 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 100 & 5.406 & 0.132 & 0.024 & 0.626 & 1.597 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 100 & 3.291 & 1.688 & 0.513 & 0.674 & 1.483 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 100 & 4.881 & 0.091 & 0.019 & 0.674 & 1.483 \\ % \hline
        demoras\_ruta\_mktid & dask & 100 & 4.991 & 0.252 & 0.05 & 0.846 & 1.182 \\ % \hline
        demoras\_ruta\_mktid & spark & 100 & 5.901 & 0.135 & 0.023 & 0.846 & 1.182 \\ % \hline
        dijkstra & dask & 100 & 3.488 & 2.448 & 0.702 & 0.206 & 4.862 \\ % \hline
        dijkstra & spark & 100 & 16.957 & 14.158 & 0.835 & 0.206 & 4.862 \\ % \hline
        elimina\_nulos & dask & 100 & 1.395 & 0.039 & 0.028 & 0.466 & 2.146 \\ % \hline
        elimina\_nulos & spark & 100 & 2.993 & 0.057 & 0.019 & 0.466 & 2.146 \\ % \hline
        flota & dask & 100 & 3.029 & 1.308 & 0.432 & 0.495 & 2.02 \\ % \hline
        flota & spark & 100 & 6.12 & 0.553 & 0.09 & 0.495 & 2.02 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos con muestra de 10 mil registros en el ambiente local.}
    \label{table:duracion10K}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.009 & 1.837 & 1.995 & 0.501 \\ % \hline
        demoras\_aerolinea & spark & 0.97 & 3.665 & 1.995 & 0.501 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.009 & 1.744 & 2.08 & 0.481 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 1.084 & 3.627 & 2.08 & 0.481 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.009 & 1.743 & 2.068 & 0.483 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 0.957 & 3.605 & 2.068 & 0.483 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.008 & 3.082 & 1.222 & 0.818 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 0.971 & 3.767 & 1.222 & 0.818 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.008 & 3.294 & 1.196 & 0.836 \\ % \hline
        demoras\_ruta\_mktid & spark & 1.009 & 3.941 & 1.196 & 0.836 \\ % \hline
        dijkstra & dask & 0.503 & 3.324 & 4.938 & 0.203 \\ % \hline
        dijkstra & spark & 1.518 & 16.413 & 4.938 & 0.203 \\ % \hline
        elimina\_nulos & dask & 0.009 & 1.395 & 2.146 & 0.466 \\ % \hline
        elimina\_nulos & spark & 1.023 & 2.993 & 2.146 & 0.466 \\ % \hline
        flota & dask & 0.008 & 1.741 & 2.714 & 0.368 \\ % \hline
        flota & spark & 1.177 & 4.725 & 2.714 & 0.368 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos con muestra de 10 mil registros en el ambiente local.}
    \label{table:otros10K}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 1.013 & 12135 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.187 & 12135 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 0.951 & 22144 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 0.195 & 22144 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 1.801 & 22086 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 1.643 & 22086 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 1.114 & 41147 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 0.209 & 41147 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 1.96 & 38909 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 1.697 & 38909 & 11 \\ % \hline
        dijkstra & spark & mysql & 0.544 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.164 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 1.395 & 12135 & 6 \\ % \hline
        flota & dask & mysql & 1.288 & 12135 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura en segundos y tamaño del resultado con muestra de 10 mil registros en el ambiente local.}
    \label{table:write10K}
\end{table}


En resumen, con la muestra de 10,000 registros, \textit{Dask} fue superior en cuatro rubros. Primero, el tiempo de ejecución donde \textit{Dask} fue especialmente rápido en la ejecución de tareas de preparación de datos y ejecución del algoritmo; en segundo lugar, el tiempo de cómputo de todos los procesos donde los resultados fueron similares a los tiempos de ejecución global; en tercer lugar, los procesos de escritura donde \textit{Dask} alcanzó una mayor diferencia de tiempo en la escritura a \texttt{parquet} pero también fue más rápido en la escritura a \textit{MySQL} y en último lugar, \textit{Dask} registró tiempos mucho menores en la ejecución del primer comando. Por otro lado, los \textit{frameworks} tuvieron un desempeño comparable en la robustez ya que ambos lograron la ejecución de todos los procesos sin fallas. Por último, \textit{Spark} registró una menor variación que \textit{Dask} en la mayor parte de los procesos. No obstante, no considero que haya información suficiente para asegurar que es más variable debido a la diferencia en los tiempos de ejecución de una herramienta y la otra y los pequeños tiempos de ejecución presentados con esta muestra de datos.


\subsection{Ejecución local con 100,000 registros}

Al usar una muestra de diez veces el tamaño de la anterior, se obtuvieron los siguientes resultados:

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 7,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  \addplot[fill=gray] coordinates { (5.187,demoras\_aerolinea)
  						(5.107,demoras\_aeropuerto\_destino)
  						(6.55,demoras\_aeropuerto\_origen)
  						(6.046,demoras\_ruta\_aeropuerto)
  						(9.264,demoras\_ruta\_mktid)
  						(22.62,dijkstra)
  						(3.048,elimina\_nulos)
  						(7.16,flota)};  
  
  \addplot[fill=orange] coordinates { (2.422,demoras\_aerolinea)
  						(2.321,demoras\_aeropuerto\_destino)
  						(6.275,demoras\_aeropuerto\_origen)
  						(4.816,demoras\_ruta\_aeropuerto)
  						(12.429,demoras\_ruta\_mktid)
  						(5.713,dijkstra)
  						(1.433,elimina\_nulos)
  						(3.737,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos con 100,000 registros en el ambiente local.}
\label{barras:duracion100K}
\end{figure}
\end{center}

\begin{itemize}
	\item \textbf{Robustez.} Con esta cantidad de datos, ambos \textit{frameworks} tuvieron resultados satisfactorios en la ejecución de sus procesos ya que se completaron sin fallos por lo que uno sigue sin superar al otro en este rubro.
	
	\item \textbf{Variación.} En esta ejecución, la desviación estándar fue casi siempre menor a 1 segundo en ambos \textit{frameworks} con algunas excepciones, como se muestra en la tabla \ref{table:duracion100K}. La variación más grande la presentó \textit{Spark} que alcanzó un coeficiente de variación de 1.07 en el proceso \textit{dijkstra}. No obstante, \textit{Dask} tuvo mayor variación en 5 de los 8 procesos, sin embargo, la mayor parte de las veces los procesos tuvieron un coeficiente de variación menor a 0.04 por lo que, en general, la variación fue pequeña en ambos.
	
	\item \textbf{Inicio de la ejecución.} La tabla \ref{table:otros100K} muestra que el tiempo de inicio de la ejecución de \textit{Dask} es significativamente menor al de \textit{Spark}, ya que el del primero es menor a 0.01 segundos en casi todos los casos (a excepción del proceso \texttt{dijkstra}) y en el caso de \textit{Spark} es de alrededor de 1 segundo en todos los casos, por lo que el comportamiento se mantiene respecto a la muestra anterior.
	
	\item \textbf{Escritura.} De acuerdo a los tiempos de escritura, \textit{Spark} fue más rápido en la escritura a \textit{MySQL} en dos de los cuatro procesos que usan este tipo de escritura (haciéndolo en menos del 63\% del tiempo que le tomó a \textit{Dask}). También tuvo un desempeño similar en dos procesos, en uno de los cuales la diferencia fue menor a 0.1 segundos (\texttt{flota}) y en el otro menor a 0.4 segundos (\texttt{dijkstra}). Esto cambió respecto a las ejecuciones con la muestra anterior donde \textit{Dask} fue más rápido. Por otro lado, \textit{Dask} registró un menor tiempo de escritura a archivos \texttt{parquet} (haciéndolo en menos del 30\% del tiempo que le tomó a \textit{Spark}) en todos los procesos, lo cual coincide con el comportamiento de la muestra anterior. Esta información está en la tabla \ref{table:write100K}.
	
	\item \textbf{Capacidad de cómputo.} La tabla \ref{table:otros100K} muestra cómo \textit{Dask} logró un menor tiempo de ejecución promedio en prácticamente todos los procesos con la excepción de \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid}. Estos procesos, que generan una nueva llave durante la ejecución, registraron tiempos tan solo entre 3\% y 8\% mayores a los de \textit{Spark}. Además, se mantuvo la diferencia importante en \texttt{dijkstra} (casi 4 veces más tardado en \textit{Spark}) y los demás procesos registraron tiempos promedio entre 80\% y 176\% mayores a \textit{Dask}.
	
	\item \textbf{Duración.} La figura \ref{barras:duracion100K} permite ver que, a excepción del proceso \texttt{demoras\_ruta\_mktid}, \textit{Dask} fue superior a \textit{Spark} en cuanto a la rapidez de ejecución de los procesos. Las menores diferencias de tiempo entre ambos \textit{frameworks} se registraron en el proceso \texttt{demoras\_aeropuerto\_origen} que consiste de un conteo y obtención del valor mínimo. La diferencia de tiempo parece estar influenciada por la escritura más rápida de \textit{Spark} a \textit{MySQL}, ya que en el proceso \texttt{demoras\_aeropuerto\_destino} la diferencia se incrementa a pesar de ser un proceso muy similar, con las diferencias de que hace la agregación a partir del aeropuerto de origen y no el de destino, calcula el mínimo en lugar del máximo y escribe a \texttt{parquet} en lugar de \textit{MySQL}. También es importante notar que el proceso \texttt{demoras\_ruta\_aeropuerto} tuvo un mayor tiempo total de ejecución a pesar de que su tiempo de cómputo fue menor, lo que muestra, una vez más, la importancia en la rapidez de escritura. Adicionalmente, el tiempo de ejecución del proceso \texttt{dijkstra} fue casi cuatro veces mayor que el de \textit{Spark}.


\end{itemize}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 100 & 2.422 & 1.351 & 0.558 & 0.467 & 2.142 \\ % \hline
        demoras\_aerolinea & spark & 100 & 5.187 & 0.384 & 0.074 & 0.467 & 2.142 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 100 & 2.321 & 0.068 & 0.029 & 0.454 & 2.2 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 100 & 5.107 & 0.089 & 0.017 & 0.454 & 2.2 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 100 & 6.275 & 0.128 & 0.02 & 0.958 & 1.044 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 100 & 6.55 & 0.262 & 0.04 & 0.958 & 1.044 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 100 & 4.816 & 0.131 & 0.027 & 0.797 & 1.255 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 100 & 6.046 & 0.093 & 0.015 & 0.797 & 1.255 \\ % \hline
        demoras\_ruta\_mktid & dask & 100 & 12.429 & 0.309 & 0.025 & 1.342 & 0.745 \\ % \hline
        demoras\_ruta\_mktid & spark & 100 & 9.264 & 0.337 & 0.036 & 1.342 & 0.745 \\ % \hline
        dijkstra & dask & 100 & 5.713 & 2.683 & 0.47 & 0.253 & 3.959 \\ % \hline
        dijkstra & spark & 100 & 22.62 & 24.204 & 1.07 & 0.253 & 3.959 \\ % \hline
        elimina\_nulos & dask & 100 & 1.433 & 0.085 & 0.06 & 0.47 & 2.127 \\ % \hline
        elimina\_nulos & spark & 100 & 3.048 & 0.054 & 0.018 & 0.47 & 2.127 \\ % \hline
        flota & dask & 100 & 3.737 & 0.146 & 0.039 & 0.522 & 1.916 \\ % \hline
        flota & spark & 100 & 7.16 & 0.147 & 0.021 & 0.522 & 1.916 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos con muestra de 100 mil registros en el ambiente local.}
    \label{table:duracion100K}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.009 & 2.217 & 1.82 & 0.549 \\ % \hline
        demoras\_aerolinea & spark & 1.325 & 4.036 & 1.82 & 0.549 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.009 & 2.072 & 1.905 & 0.525 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 0.964 & 3.947 & 1.905 & 0.525 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.008 & 2.085 & 1.899 & 0.527 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 1.027 & 3.96 & 1.899 & 0.527 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.008 & 4.34 & 0.965 & 1.036 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 0.957 & 4.188 & 0.965 & 1.036 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.008 & 5.03 & 0.926 & 1.08 \\ % \hline
        demoras\_ruta\_mktid & spark & 0.986 & 4.658 & 0.926 & 1.08 \\ % \hline
        dijkstra & dask & 0.688 & 5.543 & 3.986 & 0.251 \\ % \hline
        dijkstra & spark & 1.022 & 22.093 & 3.986 & 0.251 \\ % \hline
        elimina\_nulos & dask & 0.009 & 1.433 & 2.127 & 0.47 \\ % \hline
        elimina\_nulos & spark & 0.964 & 3.048 & 2.127 & 0.47 \\ % \hline
        flota & dask & 0.009 & 1.907 & 2.758 & 0.363 \\ % \hline
        flota & spark & 1.019 & 5.259 & 2.758 & 0.363 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos con muestra de 100 mil registros en el ambiente local.}
    \label{table:otros100K}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 1.151 & 49439 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.205 & 49439 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 1.16 & 116746 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 0.249 & 116746 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 2.59 & 116656 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 4.19 & 116656 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 1.858 & 297814 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 0.476 & 297814 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 4.606 & 267505 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 7.399 & 267505 & 11 \\ % \hline
        dijkstra & spark & mysql & 0.527 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.17 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 1.901 & 49439 & 6 \\ % \hline
        flota & dask & mysql & 1.83 & 49439 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura en segundos y tamaño del resultado con muestra de 100 mil registros en el ambiente local.}
    \label{table:write100K}
\end{table}

En conclusión, para esta muestra de datos, \textit{Dask} mantuvo el mejor desempeño en cuatro rubros. Primero, el tiempo de ejecución que no mantuvo en todos los procesos pero sí en 7 de 8; después, en el tiempo de cómputo donde fue superado por \textit{Spark} en dos casos pero mantuvo el resto; en tercer lugar, el tiempo de escritura a archivos \texttt{parquet} donde fue más rápido en todos los casos y con un margen considerable, y en cuarto lugar el tiempo de inicio de la ejecución que fue muy similar al de la muestra anterior. Por otro lado, \textit{Spark} fue superior en la escritura a \textit{MySQL} en dos de los procesos y en los otros tuvo un desempeño similar a \textit{Dask}. Además, \textit{Spark} tuvo una menor variación en muchos de los procesos pero en ambos \textit{frameworks} fue pequeña. Por último, ambas herramientas parecen ser igual de robustas ya que no tuvieron errores con este número de datos. 


\subsection{Ejecución local con 1,000,000 de registros}

Al pasar a la muestra de un millón de datos la dinámica fue algo distinta y estas son las conclusiones más importantes:

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 2,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (6.363,demoras\_aerolinea)
  						(7.137,demoras\_aeropuerto\_destino)
  						(11.607,demoras\_aeropuerto\_origen)
  						(12.019,demoras\_ruta\_aeropuerto)
  						(49.728,demoras\_ruta\_mktid)
  						(69.953,dijkstra)
  						(3.365,elimina\_nulos)
  						(8.932,flota)};  
  
  \addplot[fill=orange] coordinates { (3.629,demoras\_aerolinea)
  						(4.617,demoras\_aeropuerto\_destino)
  						(16.611,demoras\_aeropuerto\_origen)
  						(17.721,demoras\_ruta\_aeropuerto)
  						(55.405,demoras\_ruta\_mktid)
  						(31.371,dijkstra)
  						(1.817,elimina\_nulos)
  						(6.57,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos con 1,000,000 de registros en el ambiente local.}
\label{barras:duracion1M}
\end{figure}
\end{center}

\begin{itemize}
	\item \textbf{Robustez.} Ambos procesos lograron terminar el 100\% de sus ejecuciones por lo que siguen siendo igual de estables.
	
	\item \textbf{Variación.} En estas ejecuciones \textit{Dask} tuvo una variación mayor en 4 de los 8 procesos con diferencias pequeñas respecto a \textit{Spark}. Una vez más, el proceso con mayor variación para \textit{Spark} fue \texttt{dijkstra} con un coeficiente de variación de 1.344 y con todos los demás menores a 0.06. \textit{Dask}, por su parte, tuvo dos procesos con coeficiente mayor a 0.14 siendo \texttt{demoras\_aeropuerto\_destino} el proceso con mayor variación con un coeficiente de 0.289. Esta información se puede ver en la tabla \ref{table:duracion1M}.
	
	\item \textbf{Inicio de la ejecución.} Como se aprecia en la tabla \ref{table:otros1M}, en esta muestra \textit{Spark} presentó un incremento en el tiempo de inicio de la ejecución mientras que \textit{Dask} mantuvo un comportamiento similar a muestras previas. 
	
	\item \textbf{Escritura.} De acuerdo a los resultados presentados en la tabla \ref{table:write1M}, la superioridad de \textit{Dask} en la velocidad de escritura a \texttt{parquet} se mantuvo. Por otro lado, la superioridad de escritura de \textit{Spark} a \textit{MySQL} se redujo respecto a la muestra anterior ya que sólo es más rápido en dos de los procesos. Primero, en \texttt{demoras\_aeropuerto\_origen} donde el tiempo de escritura es de casi la mitad del tiempo que el de \textit{Dask} y segundo, en el proceso \texttt{flota} donde la diferencia es mínima. Además, la diferencia en el proceso \texttt{demoras\_ruta\_aeropuerto} es mucho menor y favorable a \textit{Dask} cuando en la muestra pasada \textit{Spark} había sido significativamente más rápido. 
	
	\item \textbf{Capacidad de cómputo.} Al igual que en la muestra anterior, \textit{Spark} fue más rápido sólo en los procesos \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid} en los que \textit{Dask} alcanzó tiempos entre 80\% y 148\% mayores. En \texttt{dijkstra}, \textit{Dask} mantuvo un desempeño mayor aunque \textit{Spark} fue sólo un 123\% más tardado, lo cual es una mejora importante respecto a los resultados de la muestra anterior. Sin embargo la necesidad de \textit{Spark} de escribir a disco en cada ejecución sigue dándole una amplia ventaja a \textit{Dask}. Por último, los otros procesos también tuvieron una mejora por parte de \textit{Spark} donde la duración fue entre 29\% y 58\% mayor que es grande, pero mucho menor a las diferencias observadas anteriormente. La evidencia está expuesta en la tabla \ref{table:otros1M}.
	
	\item \textbf{Duración.} A pesar de los puntos anteriores, \textit{Spark} redujo la diferencia en la razón de duración de tiempo en todos los procesos y es más rápido que \textit{Dask} en tres de ellos (\texttt{demoras\_aeropuerto\_origen}, \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid}). Esto se puede ver en los datos de la tabla \ref{table:duracion1M}. Además, la figura \ref{barras:duracion1M}, muestra que la diferencia en el tiempo de ejecución se redujo a menos del 80\% en todos los procesos (a excepción de \texttt{dijkstra}), cuando en la ejecución pasada muchos fueron más de 100\% más tardados.

\end{itemize}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 100 & 3.629 & 0.06 & 0.017 & 0.57 & 1.753 \\ % \hline
        demoras\_aerolinea & spark & 100 & 6.363 & 0.093 & 0.015 & 0.57 & 1.753 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 100 & 4.617 & 1.337 & 0.289 & 0.647 & 1.546 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 100 & 7.137 & 0.418 & 0.058 & 0.647 & 1.546 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 100 & 16.611 & 0.205 & 0.012 & 1.431 & 0.699 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 100 & 11.607 & 0.488 & 0.042 & 1.431 & 0.699 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 100 & 17.721 & 0.584 & 0.033 & 1.474 & 0.678 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 100 & 12.019 & 0.196 & 0.016 & 1.474 & 0.678 \\ % \hline
        demoras\_ruta\_mktid & dask & 100 & 55.405 & 0.564 & 0.01 & 1.114 & 0.898 \\ % \hline
        demoras\_ruta\_mktid & spark & 100 & 49.728 & 0.851 & 0.017 & 1.114 & 0.898 \\ % \hline
        dijkstra & dask & 100 & 31.371 & 4.527 & 0.144 & 0.448 & 2.23 \\ % \hline
        dijkstra & spark & 100 & 69.953 & 94.048 & 1.344 & 0.448 & 2.23 \\ % \hline
        elimina\_nulos & dask & 100 & 1.817 & 0.039 & 0.021 & 0.54 & 1.852 \\ % \hline
        elimina\_nulos & spark & 100 & 3.365 & 0.043 & 0.013 & 0.54 & 1.852 \\ % \hline
        flota & dask & 100 & 6.57 & 0.093 & 0.014 & 0.736 & 1.36 \\ % \hline
        flota & spark & 100 & 8.932 & 0.175 & 0.02 & 0.736 & 1.36 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos con muestra de 1 millón de registros en el ambiente local.}
    \label{table:duracion1M}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.008 & 3.381 & 1.518 & 0.659 \\ % \hline
        demoras\_aerolinea & spark & 5.545 & 5.132 & 1.518 & 0.659 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.009 & 4.12 & 1.294 & 0.773 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 0.977 & 5.331 & 1.294 & 0.773 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.009 & 4.038 & 1.31 & 0.763 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 3.144 & 5.291 & 1.31 & 0.763 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.008 & 15.885 & 0.403 & 2.482 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 3.769 & 6.401 & 0.403 & 2.482 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.009 & 17.364 & 0.531 & 1.882 \\ % \hline
        demoras\_ruta\_mktid & spark & 3.95 & 9.228 & 0.531 & 1.882 \\ % \hline
        dijkstra & dask & 1.975 & 31.12 & 2.23 & 0.448 \\ % \hline
        dijkstra & spark & 7.847 & 69.412 & 2.23 & 0.448 \\ % \hline
        elimina\_nulos & dask & 0.009 & 1.817 & 1.852 & 0.54 \\ % \hline
        elimina\_nulos & spark & 1.093 & 3.365 & 1.852 & 0.54 \\ % \hline
        flota & dask & 0.009 & 4.389 & 1.574 & 0.635 \\ % \hline
        flota & spark & 0.951 & 6.908 & 1.574 & 0.635 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos con muestra de 1 millón de registros en el ambiente local.}
    \label{table:otros1M}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 1.231 & 76717 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.248 & 76717 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 1.806 & 436411 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 0.497 & 436411 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 6.316 & 436681 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 12.573 & 436681 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 5.618 & 1619826 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 1.836 & 1619826 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 40.5 & 1430282 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 38.041 & 1430282 & 11 \\ % \hline
        dijkstra & spark & mysql & 0.541 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.251 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 2.024 & 76717 & 6 \\ % \hline
        flota & dask & mysql & 2.181 & 76717 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura en segundos y tamaño del resultado con muestra de 1 millón de registros en el ambiente local.}
    \label{table:write1M}
\end{table}

En conclusión, podemos ver que al incrementar la muestra de datos la superioridad de \textit{Spark} en la escritura a \textit{MySQL} que parecía existir anteriormente no es tan clara, pero se acentúa su mejor desempeño al operar con una nueva llave. Por otro lado, \textit{Dask} aún conserva la ventaja de la escritura a \texttt{parquet} y es más rápido en la ejecución del proceso (sin contar el tiempo de escritura) en todos los procesos que no requieren de la creación de una nueva llave. Sin embargo, la ventaja respecto a \textit{Spark} se redujo significativamente, esto es especialmente evidente al ver el tiempo de cómputo. En cuanto a la robustez y variación, ambos \textit{frameworks} tienen resultados similares con \textit{Spark} siendo un poco más consistente en la duración de sus ejecuciones. Por último, en el algoritmo iterativo \textit{Dask} sigue teniendo mejor desempeño gracias a su capacidad de mantener en memoria resultados intermedios.

\subsection{Ejecución local con 11,000,000 registros}

Esta última serie de ejecuciones en el ambiente local, el conjunto de datos es más grande de lo que se recomendaría ejecutar en un ambiente \textit{standalone}, debido a que requiere una gran cantidad de recursos por lo que inhabilita el uso del equipo para otras tareas. Además, presenta tiempos de ejecución significativamente mayores a los de las muestras anteriores. Sin embargo, su ejecución aporta información relevante respecto a la evolución del comportamiento de las herramientas y somete a mayor presión a los \textit{frameworks}. Por esta razón consideré que su ejecución sería provechosa para este análisis ya que permite visualizar las capacidades de los \textit{frameworks} en condiciones más demandantes. Las conclusiones más relevantes obtenidas se listan a continuación.

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 0.7,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (6.363,demoras\_aerolinea)
  						(7.137,demoras\_aeropuerto\_destino)
  						(11.607,demoras\_aeropuerto\_origen)
  						(12.019,demoras\_ruta\_aeropuerto)
  						(49.728,demoras\_ruta\_mktid)
  						(229.471,dijkstra)
  						(3.365,elimina\_nulos)
  						(8.932,flota)};
  
  \addplot[fill=orange] coordinates { (8.604,demoras\_aerolinea)
  						(11.123,demoras\_aeropuerto\_destino)
  						(38.7,demoras\_aeropuerto\_origen)
  						(93.087,demoras\_ruta\_aeropuerto)
  						(113.341,dijkstra)
  						(1.817,elimina\_nulos)
  						(6.57,flota)};
                         
  \legend{Spark, Dask}
  % \node[] at (A) {absolute in pgfplots coordinates};
  \end{axis}
  \coordinate (A) at (1.75,4.6);
  \node at (A) {\textbf{\color{orange}{Error de memoria}}};
\end{tikzpicture}
\caption{Duración en segundos de los procesos con 11,000,000 de registros en el ambiente local.}
\label{barras:duracion10M}
\end{figure}
\end{center}

\begin{itemize}

	\item \textbf{Robustez.} En la ejecución de los procesos con esta muestra de datos \textit{Dask} presentó problemas en de falta de memoria en las ejecuciones del proceso \texttt{demoras\_ruta\_mktid} por lo que no completó ninguna de las 100 ejecuciones. Algo similar se registró en \cite{comparative-evolution} con un ambiente parecido. El problema de memoria aparece cuando \textit{Dask} calcula el resultado final y lo intenta escribir a \textit{MySQL}. Por el contrario, \textit{Spark} completó el 100\% de las ejecuciones en todos los procesos, por lo que parece escalar de forma más estable y tener una mejor administración del uso de recursos. La evidencia de esto se resume en la tabla \ref{table:duracion10M}.
	
	\item \textbf{Variación.} Al ver los resultados de la tabla \ref{table:duracion10M}, observamos que el coeficiente de variación es menor para \textit{Dask} en todos los procesos, por lo que este \textit{framework} es más consistente en sus tiempos de ejecución. Sin embargo, en ambos \textit{frameworks}, el coeficiente es menor a 0.2 en la mayoría de los procesos y las excepciones corresponden a dos procesos de \textit{Spark}: \texttt{dijkstra}, que varía ya que calcula una ruta elegida de forma aleatoria en cada ejecución, y \texttt{elimina\_nulos}, el proceso de menor duración y cuya variación es menor a dos décimas de segundo para \textit{Dask} y menor a 1 segundo para \textit{Spark}, lo que explica el valor alto del coeficiente.
	
	\item \textbf{Inicio de la ejecución.} A excepción del proceso \texttt{dijkstra}, el tiempo de inicio de la ejecución sigue siendo mucho menor para \textit{Dask}. Eso se puede ver en la tabla \ref{table:otros10M}.
	
	\item \textbf{Escritura.} De acuerdo a los datos expuestos en la tabla \ref{table:write10M}, \textit{Dask} mantiene tiempos menores a los registrados por \textit{Spark} en la escritura de datos a archivos \texttt{parquet}. Por otro lado, \textit{Spark} sigue teniendo un tiempo de escritura menor a \textit{MySQL} en el proceso \texttt{demoras\_aeropuerto\_origen} y un tiempo similar los procesos \texttt{dijkstra} y \texttt{flota}. Del proceso \texttt{demoras\_ruta\_mktid} no tenemos información para comparar. 
	
	\item \textbf{Capacidad de cómputo.} Al ver el tiempo de cómputo presentado en la tabla \ref{table:otros10M}, vemos que a \textit{Dask} le toma cerca de 17\% más tiempo completar el cálculo de los procesos \texttt{demoras\_aerolinea}, \texttt{demoras\_aeropuerto\_destino} y \texttt{demoras\_aeropuerto\_origen}. Además, en el proceso \texttt{flota}, \textit{Spark} es solo un 1\% más tardado y en el proceso \texttt{demoras\_ruta\_aeropuerto} a \textit{Dask} le tomó casi 6 veces el tiempo que a \textit{Spark} completar el cómputo del resultado. El único proceso en el que \textit{Dask} conserva su superioridad es en \texttt{dijkstra} donde su tiempo de ejecución es un 50\% del registrado por \textit{Spark}. 
	
	\item \textbf{Duración.} Con los resultados de esta ejecución, resumida en el gráfico \ref{barras:duracion10M}, observamos que \textit{Spark} sigue siendo más rápido en los procesos \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_aeropuerto\_origen} considerando el tiempo total. En el primer caso con una diferencia mayor que en la muestra anterior y explicada principalmente por el tiempo de cómputo y, en el caso del proceso \texttt{demoras\_aeropuerto\_origen}, la diferencia se debe principalmente a una escritura más rápida por parte de \texttt{Spark} aunque el tiempo de cómputo también es más rápido que en \textit{Dask}. En el caso de los procesos \texttt{demoras\_aerolinea} y \texttt{demoras\_aeropuerto\_destino}, \textit{Dask} registró un menor tiempo promedio de ejecución a pesar de alcanzar valores más altos en el tiempo de cómputo, por lo que la ventaja de escritura a \texttt{parquet} sigue siendo un factor importante en su superioridad sobre \textit{Spark} en el tiempo global de ejecución. Aún así, estos dos procesos tuvieron tiempos 4\% y 19\% mayores en \textit{Spark}, respectivamente. Por otro lado, el tiempo de ejecución total del proceso \texttt{flota} fue sólo un 1\% mayor en \textit{Dask} que en \textit{Spark} y sus tiempos de escritura y cómputo fueron muy similares. Adicionalmente, los procesos \texttt{elimina\_nulos} y \texttt{dijkstra} siguen siendo muy superiores en \textit{Dask} ya que alcanzaron tiempos 44\% y 102\% superiores en \textit{Spark}, respectivamente. Además, es importante ver que el proceso \texttt{elimina\_nulos} ha incrementado menos de 1 segundo en ambos \textit{frameworks} a pesar de que la muestra de datos es 1000 veces mayor a la original. En este proceso \textit{Dask} ha mantenido la ventaja consistentemente. En suma, \textit{Spark} fue más rápido en 2 procesos de 7 pero tuvo diferencias menores al 4\% en dos más, por lo que la diferencia entre \textit{Dask} y \textit{Spark} se redujo aún más.

\end{itemize}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 100 & 8.604 & 0.057 & 0.007 & 0.959 & 1.043 \\ %\hline
        demoras\_aerolinea & spark & 100 & 8.97 & 0.169 & 0.019 & 0.959 & 1.043 \\ %\hline
        demoras\_aeropuerto\_destino & dask & 100 & 11.123 & 0.12 & 0.011 & 0.838 & 1.194 \\ %\hline
        demoras\_aeropuerto\_destino & spark & 100 & 13.28 & 0.169 & 0.013 & 0.838 & 1.194 \\ %\hline
        demoras\_aeropuerto\_origen & dask & 100 & 38.7 & 1.933 & 0.05 & 1.213 & 0.825 \\ %\hline
        demoras\_aeropuerto\_origen & spark & 100 & 31.913 & 1.287 & 0.04 & 1.213 & 0.825 \\ %\hline
        demoras\_ruta\_aeropuerto & dask & 100 & 93.087 & 6.446 & 0.069 & 2.147 & 0.466 \\ %\hline
        demoras\_ruta\_aeropuerto & spark & 100 & 43.351 & 2.047 & 0.047 & 2.147 & 0.466 \\ %\hline
        demoras\_ruta\_mktid & spark & 100 & 251.942 & 3.392 & 0.013 & NA & NA \\ %\hline
        dijkstra & dask & 100 & 113.341 & 20.355 & 0.18 & 0.494 & 2.025 \\ %\hline
        dijkstra & spark & 100 & 229.471 & 327.859 & 1.429 & 0.494 & 2.025 \\ %\hline
        elimina\_nulos & dask & 100 & 2.941 & 0.119 & 0.041 & 0.692 & 1.446 \\ %\hline
        elimina\_nulos & spark & 100 & 4.253 & 0.95 & 0.223 & 0.692 & 1.446 \\ %\hline
        flota & dask & 100 & 14.304 & 0.125 & 0.009 & 0.991 & 1.01 \\ %\hline
        flota & spark & 100 & 14.44 & 0.27 & 0.019 & 0.991 & 1.01 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos con muestra de 10 millones de registros en el ambiente local.}
    \label{table:duracion10M}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.008 & 8.383 & 0.854 & 1.171 \\ % \hline
        demoras\_aerolinea & spark & 1.039 & 7.16 & 0.854 & 1.171 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.008 & 10.116 & 0.851 & 1.175 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 0.968 & 8.612 & 0.851 & 1.175 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.009 & 10.306 & 0.847 & 1.181 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 1.033 & 8.729 & 0.847 & 1.181 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.009 & 78.139 & 0.173 & 5.769 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 0.963 & 13.544 & 0.173 & 5.769 \\ % \hline
        demoras\_ruta\_mktid & spark & 1.208 & 29.576 & NA & NA \\ % \hline
        dijkstra & dask & 2.85 & 112.988 & 2.025 & 0.494 \\ % \hline
        dijkstra & spark & 1.562 & 228.843 & 2.025 & 0.494 \\ % \hline
        elimina\_nulos & dask & 0.009 & NA & NA & NA \\ % \hline
        elimina\_nulos & spark & 1.039 & NA & NA & NA \\ % \hline
        flota & dask & 0.009 & 12.158 & 1.011 & 0.99 \\ % \hline
        flota & spark & 0.972 & 12.286 & 1.011 & 0.99 \\  \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos con muestra de 11 millones de registros en el ambiente local.}
    \label{table:otros10M}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 1.81 & 78113 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.221 & 78113 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 4.668 & 1042066 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 1.007 & 1042066 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 23.184 & 1041665 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 28.394 & 1041665 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 29.807 & 8361958 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 14.948 & 8361958 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 222.366 & 6824834 & 11 \\ % \hline
        dijkstra & spark & mysql & 0.628 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.353 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & consola & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & consola & NA & NA & NA \\ % \hline
        flota & spark & mysql & 2.154 & 78113 & 6 \\ % \hline
        flota & dask & mysql & 2.146 & 78113 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura en segundos y tamaño del resultado con muestra de 11 millones de registros en el ambiente local.}
    \label{table:write10M}
\end{table}

Sintetizando, con esta muestra de datos \textit{Spark} fue superior en la robustez ya que logró completar todos los procesos y \textit{Dask} presentó problemas de memoria en uno de ellos. \textit{Dask}, por su parte, sigue teniendo un mejor desempeño en la escritura a \texttt{parquet}, en el tiempo de inicio de la ejecución, en el la variación del tiempo de ejecución y en el tiempo total de ejecución, aunque la diferencia con \textit{Spark} se sigue reduciendo. Por otro lado, en el tiempo de cómputo, \textit{Spark} fue más rápido en 3 de los 7 procesos y tuvo un desempeño casi igual en un cuarto, por lo que la superioridad de \textit{Dask} ya no es tan evidente. Sin embargo, en los procesos \texttt{dijkstra} y \texttt{elimina\_nulos} sí mantuvo una superioridad importante y con una diferencia mucho mayor que las que presentaron los procesos en los que \textit{Spark} fue más rápido.


\subsection{Cambio del desempeño entre muestras}
\label{subsection:cambio-muestras-local}

Después de haber revisado de forma independiente cada muestra, podemos pasar al análisis del comportamiento de cada \textit{framework} a través de las distintas muestras y procesos. Esta sección se centrará en: el promedio de tiempo de ejecución registrado, el tiempo de escritura y su dinámica al incrementar el tamaño de los datos a procesar. Primero, se hará un análisis de cada proceso individual y después se obtendrán conclusiones generales sobre cada herramienta. En esta sección también se incluye información más detallada sobre el número de registros que escribe cada proceso a sus respectivos destinos (\texttt{parquet} o \textit{MySQL}). Es importante mencionar que el número de registros escritos no crece de forma proporcional al tamaño de los datos que se procesan, ya que la mayoría de los procesos tienen datos agregados como resultado final.

\subsubsection{Proceso de cálculo de flota}

Este proceso es uno de los que registró menos tiempo de ejecución en las distintas muestras y uno en el que \textit{Dask} fue superior en la mayoría de los conjuntos de datos. Sus operaciones más importantes son la eliminación de registros duplicados en una columna y su posterior conteo agrupando por distintas columnas con valores de tiempo. El resultado se escribe a \textit{MySQL}.

La figura \ref{lineas:local-flota} muestra cómo varía la diferencia entre \textit{Dask} y \textit{Spark} al incrementar el número de datos a procesar, empezando por 10,000 y llegando hasta aproximadamente 11 millones. En la figura es claro como el incremento de tiempo de ambos \textit{frameworks} es pequeño (de entre 8 y 11 segundos) comparado con el número de registros que tiene que procesar. Aunque el cuarto punto corresponde a un conjunto de datos 1000 veces mayor que el inicial, el tiempo promedio registrado es cercano a 3 veces mayor en el caso de \textit{Spark} y 4 en el caso de \textit{Dask}. Esto muestra una importante capacidad de procesamiento de datos con un pequeño incremento de tiempo transcurrido. 
\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 3.029 1.308
      100000 3.737 0.146
      1000000 6.57 0.093
      11000000 14.304 0.125
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 6.12 0.553
      100000 7.16 0.147
      1000000 8.932 0.175
      11000000 14.44 0.27
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso flota en diferentes muestras.}
\label{lineas:local-flota}
\end{figure}

Al analizar los tiempos de escritura a \textit{MySQL}, representados en la figura \ref{lineas:local-flota-write}, podemos ver que no fueron un factor importante para el tiempo de ejecución, ya que el aumento de tiempo de la primera a la última muestra no fue significativo. Además, no se observa una mejora clara en el desempeño de ninguna de las herramientas conforme los datos aumentan. En particular, en la muestra de 11 millones, ambos \textit{frameworks} presentan un cambio importante en la tendencia que estaban presentando, \textit{Spark} aumentando significativamente el tiempo de ejecución con un pequeño incremento en el número de registros y \textit{Dask} incluso mejorando el tiempo de escritura a pesar del aumento de registros.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 1.288 0.169
      49439 1.83 0.101
      76717 2.181 0.079
      78113 2.146 0.072
       
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 1.395 0.121
      49439 1.901 0.132
      76717 2.024 0.149
      78113 2.154 0.188
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso flota en diferentes muestras en el ambiente local.}
\label{lineas:local-flota-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por aerolínea}

Este proceso tiene como operaciones principales conteo de una columna y obtención de promedios de otras 5, agrupando respecto a distintas columnas de tiempo. El resultado final se almacena en un archivo \texttt{parquet}.

Al analizar los resultados representados por la figura \ref{lineas:local-demoras-aerolinea}, podemos ver que el incremento de tiempo de la primera a la cuarta muestra es pequeño comparado con el aumento del conjunto de datos (es cerca de 1000 veces mayor). Sin embargo, cuando se llega a la última muestra se aprecia un incremento mucho mayor a los observados anteriormente. Adicionalmente, en la última muestra \textit{Spark} se acerca mucho al desempeño de \textit{Dask}, lo que sugiere que \textit{Spark} se vuelve más competitivo conforme aumenta el tamaño del conjunto de datos. 

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 2.024 0.048
      100000 2.422 0.042
      1000000 3.629 0.06
      11000000 8.604 0.057
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 4.678 0.065
      100000 5.187 0.0384
      1000000 6.363 0.093
      11000000 8.97 0.169
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_aerolinea en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-aerolinea}
\end{figure}

Por otra parte, analizando los resultados de la escritura, representados por la figura \ref{lineas:local-demoras-aerolinea-write}, podemos ver que el tiempo de escritura de ambos \textit{frameworks} es muy bajo y que \textit{Dask} es especialmente constante en el tiempo de escritura a pesar del incremento de su tamaño, sin embargo, considerando el poco tiempo que este proceso toma, la escritura a archivos \texttt{parquet} no  es un factor importante en la duración total debido a la velocidad de escritura de ambas herramientas y el bajo incremento del tamaño del \textit{DataFrame} resultante.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 0.187 0.03
      49439 0.205 0.057
      76717 0.248 0.037
      78113 0.221 0.031
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 1.013 0.03
      49439 1.151 0.042
      76717 1.231 0.056
      78113 1.81 0.064
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de escritura de resultados del proceso demoras\_aerolinea en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-aerolinea-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por aeropuerto de destino}

Este proceso tiene como operaciones principales el conteo en una columna y la obtención del mínimo de otras 5, agrupando de acuerdo a distintos periodos de tiempo representados en diversas columnas. El resultado del proceso se escribe en un archivo \texttt{parquet}.

Observando al figura \ref{lineas:local-demoras-aeropuerto-destino}, podemos ver que entre la primera y la última muestra, el incremento de tiempo del proceso es de cerca de 10 segundos, que se traduce en un tiempo aproximadamente 5 y 2 veces mayor que el inicial para \textit{Dask} y \textit{Spark} respectivamente. Esto a pesar de que el cuarto conjunto de datos es más de 1000 veces mayor que el de la primera muestra. Esto evidencia una gran capacidad para procesar más y más datos con los mismos recursos y poco incremento en el tiempo de ejecución por parte de ambos \textit{frameworks}. Sin embargo, \textit{Dask} tiene un mejor desempeño, ya que ejecuta todos los procesos más rápido que \textit{Spark}, con una diferencia de pocos segundos en las cuatro muestras. En este caso, \textit{Dask} muestra una mayor capacidad para procesar cantidades de datos cada vez más grandes ya que los completa en menor tiempo y mantiene una diferencia de tiempo constante respecto a \textit{Spark}.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 1.939 0.043
      100000 2.321 0.068
      1000000 4.617 0.037
      11000000 11.123 0.12
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 4.578 0.064
      100000 5.107 0.089
      1000000 7.137 0.0418
      11000000 13.28 0.169
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_aeropuerto\_destino en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-aeropuerto-destino}
\end{figure}

Al analizar el tiempo de escritura, representado en la figura \ref{lineas:local-demoras-aeropuerto-destino-write}, podemos apreciar que, conforme crece la muestra de datos, \textit{Dask} tiene un menor incremento de tiempo de \textit{Spark}. Esto resulta en que la diferencia en el tiempo de escritura crezca con el tiempo. Además, la tendencia observada en la figura \ref{lineas:local-demoras-aeropuerto-destino} es similar a la representada en la figura de escritura. Sin embargo, es notoria la ventaja de \textit{Dask} al escribir al resultado, lo que ayuda a mantener la brecha de tiempo en la duración total de la ejecución respecto a \textit{Spark} a través de las muestras.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22144 0.195 0.024  
      116746 0.249 0.041 
      436411 0.497 0.052 
      1042066 1.007 0.041
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22144 0.951 0.031  
	  116746 1.16 0.062  
	  436411 1.806 0.057 
	  1042066 4.668 0.083
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_aeropuerto\_destino en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-aeropuerto-destino-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por aeropuerto de origen}

Este proceso tiene como operaciones principales el conteo en una columna y la obtención del máximo de otras cinco, agrupando de acuerdo a distintos periodos de tiempo representados en diversas columnas. El resultado del proceso se escribe a una base de datos \textit{MySQL}.

Como se ve en la figura \ref{lineas:local-demoras-aeropuerto-origen}, en este proceso los \textit{frameworks} tienen un comportamiento similar a través de las distintas muestras. Sin embargo, a diferencia de otros procesos, \textit{Spark} supera a \textit{Dask} en desempeño durante las muestras de 1 millón y 11 millones de registros. Al analizar la figura \ref{lineas:local-demoras-aeropuerto-origen-write} podemos encontrar que la superioridad de \textit{Spark} para escribir a \textit{MySQL} conforme crece el resultado escrito es un factor para que \textit{Spark} haya registrado tiempos de ejecución total menores con las muestras más grandes. 

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 3.386 0.095
      100000 6.275 0.128
      1000000 16.611 0.205
      11000000 38.7 1.933
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 5.406 0.132
      100000 6.55 0.262
      1000000 11.607 0.488
      11000000 31.913 1.287
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_aeropuerto\_origen en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-aeropuerto-origen}
\end{figure}

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22086 1.643 0.087
      116656 4.19 0.119
      436681 12.573 0.189
      1041665 28.394 0.355
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22086 1.801 0.125 
	  116656 2.59 0.255  
	  436681 6.316 0.479
	  1041665 23.184 0.774
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_aeropuerto\_origen en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-aeropuerto-origen-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por ruta entre aeropuertos}

El proceso \texttt{demoras\_ruta\_aeropuertos} tiene como operaciones principales las siguientes: creación de una nueva llave a partir de la concatenación de dos columnas existentes, un conteo en una columna y el cálculo del promedio en otras 5. Esto lo hace agrupando de acuerdo a la nueva llave y a otras columnas que describen periodos de tiempo. El resultado final se escribe a un archivo \texttt{parquet}.

La figura \ref{lineas:local-demoras-ruta-aeropuerto} muestra como las herramientas tienen un desempeño muy similar en las primeras dos muestras y como \textit{Spark} es ligeramente superior a partir de la muestra de 1 millón de datos. Esta diferencia se incrementa significativamente en la muestra de 11 millones de datos. 

Por otro lado, al observar la figura \ref{lineas:local-demoras-ruta-aeropuerto-write} podemos ver que a \textit{Spark} le toma más tiempo escribir resultados a archivos \texttt{parquet} y a pesar de ello tiene un desempeño superior. Esto muestra que la rapidez de \textit{Spark} viene de su capacidad de procesamiento y creación de una nueva llave.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 3.291 1.688
      100000 4.816 0.131
      1000000 17.721 0.584
      11000000 93.087 6.446
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 4.881 0.091
      100000 6.046 0.093
      1000000 12.019 0.196
      11000000 43.351 2.047
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_ruta\_aeropuerto en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-ruta-aeropuerto}
\end{figure}

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      41147 0.209 0.046
      297814 0.476 0.047
      1619826 1.836 0.029
      8361958 14.948 3.378
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      41147 1.114 0.047
	  297814 1.858 0.088
	  1619826 5.618 0.19
	  8361958 29.807 0.501
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_ruta\_aeropuerto en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-ruta-aeropuerto-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por ruta entre ciudades}

Este proceso tiene como operaciones principales: la creación de una nueva llave a partir de la concatenación de dos columnas existentes, un conteo en una columna y cálculo de la desviación estándar en otras 5. Esto agrupando de acuerdo a la nueva llave y a otras columnas que describen periodos de tiempo. El resultado final se escribe a una base de datos \textit{MySQL}. Es importante mencionar que este es el proceso más demandante de los implementados debido a: el tipo de operación que calcula, el número de registros que utiliza, a que el tamaño de su resultado es de los más grandes y que la escritura a \textit{MySQL} ha probado ser más costosa que a archivos \texttt{parquet}.

La figura \ref{lineas:local-demoras-ruta-mktid} muestra que, al principio, la diferencia entre la rapidez de ejecución de ambos \textit{frameworks} es muy pequeña. Sin embargo, a partir de la muestra de 11 millones de datos, \textit{Dask} tiene problemas de memoria y no logra finalizar la ejecución.

La figura \ref{lineas:local-demoras-ruta-mktid-write} muestra que el tiempo de escritura crece de una forma menos acelerada que el tiempo de ejecución total. Además, es interesante ver cómo en el caso de \textit{Spark} aproximadamente un 40\% del tiempo total corresponde al tiempo de escritura. Por otro lado, debido a la falta de información sobre \textit{Dask}, no podemos obtener conclusiones concretas sobre la última ejecución y su tiempo de escritura a \textit{MySQL}. 

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 4.991 0.252
      100000 12.429 0.309
      1000000 55.405 0.564
      % 11000000 NA NA
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 5.901 0.135
      100000 9.264 0.337
      1000000 49.728 0.851
      11000000 251.942 3.392
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_ruta\_mktid en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-ruta-mktid}
\end{figure}


\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      38909 1.697 0.248
      267505 7.399 0.289
      1430282 38.041 0.283
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      38909 1.96 0.12
	  267505 4.606 0.325
	  1430282 40.5 0.839
	  6824834 222.366 3.282
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_ruta\_mktid en diferentes muestras en el ambiente local.}
\label{lineas:local-demoras-ruta-mktid-write}
\end{figure}

\subsubsection{Proceso de cálculo de eliminación de valores nulos}

Este proceso tiene como operaciones principales la eliminación de valores nulos y el conteo de registros resultantes. Debido a que sólo escribe el resultado a consola, el tiempo de escritura no fue considerado.

Los resultados de ejecución de este proceso están representados por la figura \ref{lineas:local-elimina-nulos}. Esta figura muestra una pequeña superioridad de \textit{Dask} durante las primeras muestras (menos de 2 segundos de diferencia) pero también muestra una evolución similar del tiempo de ejecución respecto al número de registros de ambos \textit{frameworks}. 

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 1.395 0.039
      100000 1.433 0.085
      1000000 1.817 0.039
      11000000 2.941 0.119
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 2.993 0.057
      100000 3.048 0.054
      1000000 3.365 0.043
      11000000 4.253 0.95
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso elimina\_nulos en diferentes muestras en el ambiente local.}
\label{lineas:local-elimina-nulos}
\end{figure}

\subsubsection{Proceso de obtención de ruta mínima mediante el algoritmo \textit{Dijkstra}}

Este proceso tiene múltiples operaciones como conteos, filtrados, ordenamientos, etc. No obstante, su característica más importante es que se trata de un algoritmo iterativo, lo cual ayudó a evaluar cuál de los dos \textit{frameworks} es mejor en: el almacenamiento temporal de resultados intermedios, la creación de nuevos \textit{DataFrames} y el manejo de memoria. El resultado de este algoritmo varía de acuerdo a la ruta calculada en el algoritmo, y como cada registro en el \textit{DataFrame} corresponde a un vuelo elegido, este tiene entre tres y cuatro registros la mayoría de las veces, por lo que el tiempo de escritura no se considerará en este análisis.

La figura \ref{lineas:local-dijkstra} muestra claramente cómo la diferencia de tiempo de ejecución entre \textit{Dask} y \textit{Spark} crece junto con el tamaño de la muestra. Esto se debe a que el tiempo en cada iteración de \textit{Spark} aumenta significativamente. Esto debido a que, a diferencia de \textit{Dask}, no tiene la capacidad de mantener en memoria los resultados intermedios del algoritmo y es necesario escribir a disco, lo cual es muy costoso. No obstante, es importante notar que los resultados de \textit{Dask} se convierten en un \textit{DataFrame} de \textit{Pandas} al llamar la operación \texttt{compute}, por lo que podría llegar a ser inestable si los resultados intermedios crecen demasiado.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 3.488 2.448
      100000 5.713 2.683
      1000000 31.371 4.527
      11000000 113.341 20.355
      % 80000000 NA NA
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 16.957 14.158
      100000 22.62 24.204
      1000000 69.953 94.048
      11000000 229.471 327.859
      % 80000000 NA NA
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso dijkstra en diferentes muestras en el ambiente local.}
\label{lineas:local-dijkstra}
\end{figure}

\subsection{Conclusiones generales sobre las ejecuciones locales}

Esta sección tiene como objetivo resumir las conclusiones principales, sobre cada rubro, que se obtuvieron durante las ejecuciones locales.

\begin{itemize}
	
	\item \textbf{Robustez.} En este rubro, ambos \textit{frameworks} registraron resultados satisfactorios durante las primeras tres muestras Sin embargo, al alcanzar los 11 millones de registros, \textit{Dask} tuvo problemas de memoria que le impidieron terminar el proceso. Estos problemas se presentaron durante la escritura a \textit{MySQL}. Mientras tanto, \textit{Spark} logró terminar el 100\% de las ejecuciones sin presentar problemas. Lo anterior, muestra que \textit{Spark} es más robusto que \textit{Dask} bajo las condiciones del experimento.
	
	\item \textbf{Variación.} Este aspecto es uno en el que la relación entre las dos herramientas cambian, debido a que durante las dos muestras más pequeñas es \textit{Spark} quien registra menor variación en la mayoría de los procesos (considerando el coeficiente de variación). Sin embargo, esto está fuertemente influenciado por los cortos tiempos de ejecución que registra \textit{Dask}. De hecho, en la tercera muestra, la tendencia cambia ya que \textit{Dask} registra un coeficiente menor en cuatro de los ocho procesos. Finalmente, la tendencia se invierte cuando \textit{Dask} registra coeficientes más bajos en todos los procesos. Adicional a esto, la mayoría de las veces también la desviación estándar de los procesos registrados por \textit{Dask} fue menor, por lo que considero que es el \textit{framework} que registró menos variaciones.
	
	\item \textbf{Inicio de la ejecución.} La rapidez para iniciar la ejecución de un proceso es sin duda superior en \textit{Dask}, ya que registró tiempos menores en todos los casos y no registró cambios importantes de duración durante las diferentes muestras. \textit{Spark} tampoco mostró tiempos de ejecución muy diferentes al cambiar de muestras y sí registró tiempos más grandes. Esto parece estar influenciado por qué requiere de un mayor número de parámetros para iniciar la ejecución (como \texttt{driver-memory}) y además requiere de la carga de algunos recursos adicionales como los \texttt{jars}. Sin embargo, en ambas herramientas, este tiempo fue menor a 2 segundos la mayoría de las veces, por lo que para procesos con mayor duración este tiempo inicial pierde importancia.
	
	\item \textbf{Escritura.} Quizá la conclusión más notoria en este aspecto es la superioridad de \textit{Dask} en la escritura de archivos \texttt{parquet}, donde siempre registró tiempos de escritura menores al 50\% de lo requerido por \textit{Spark}. Además, en la mayoría de ellos el tiempo requerido fue menor a un cuarto del requerido por \textit{Spark}. Lo más interesante de esto es que sucedió consistentemente a través de los diferentes procesos y muestras de datos, lo que muestra la clara ventaja de \textit{Dask} para la escritura a este tipo de archivo. En el caso de la escritura a \textit{MySQL} es más difícil determinar cuál de los dos \textit{frameworks} tiene un mejor desempeño ya que las razones de duración tuvieron grandes diferencias y favorecían a distintas herramientas bajo distintas condiciones, sin embargo, cuando \textit{Dask} registraba tiempos menores de escritura, lograba finalizar el proceso en hasta 87\% del tiempo registrado por \textit{Spark}, pero no menor a eso. Por otro lado, cuando \textit{Spark} fue más rápido, llegó a registrar tiempos de escritura en hasta la mitad del tiempo que \textit{Dask}, por lo que considero que \textit{Spark} fue superior en este aspecto, ya que aún cuando registraba tiempos mayores estos no eran muy diferentes a los de \textit{Dask}. Por último, durante la ejecución de los procesos fue evidente que la escritura a \texttt{parquet} es significativamente más rápida que la escritura a bases de datos en ambos \textit{frameworks}, lo cuál es consistente con lo que aconsejan en sus mejores prácticas. A pesar de lo anterior, la ventaja de \textit{Dask} en la escritura pierde importancia en las muestras de mayor tamaño, esto debido a que el tamaño del resultado no crece de forma proporcional al conjunto de datos procesado, sin embargo, en tareas en las que esto suceda, \textit{Dask} tendría una ventaja importante cuando el destino son archivos \texttt{parquet}.
		
	\item \textbf{Capacidad de cómputo.} Este aspecto es uno de los que más cambios presentó a través de las distintas muestras. Por ejemplo, en la primera, \textit{Dask} fue superior en todos los procesos aunque con diferencias pequeñas en los que involucraban la creación de una nueva llave y agregaciones respecto a la misma, y en el resto de los procesos \textit{Spark} tuvo tiempos de casi el doble de duración que los de \textit{Dask}. Por otro lado, en las siguientes muestras \textit{Spark} registró tiempos menores en los procesos que involucraban una llave nueva y la diferencia de tiempo se incrementó considerablemente respecto a la de \textit{Dask} conforme el tamaño del conjunto de datos aumentaba, pasando de una duración adicional de entre 3\% y 8\% en la muestra de 100,000 hasta 476\% en la de 10 millones en el proceso \texttt{demoras\_ruta\_aeropuerto}. Otro caso especial fue el proceso \texttt{dijkstra}, en el que \textit{Dask} fue significativamente superior debido a su mejor manejo de resultados anteriores en memoria y al mejor desempeño de la función \texttt{persist} que la función \texttt{checkpoint} utilizada con \textit{Spark}. La gran diferencia fue que \textit{Dask} tiene una mayor capacidad para acortar el plan de ejecución en cada iteración, mientras que \textit{Spark} tiene que escribir forzosamente a disco para lograr esto y esa operación es muy costosa. Por otro lado, en los procesos de agregación (\texttt{demoras\_aerolinea}, \texttt{demoras\_aeropuerto\_destino} y \texttt{demoras\_aeropuerto\_origen}), \textit{Dask} fue superior en el cálculo durante las tres primeras muestras pero \textit{Spark} fue acercándose a su tiempo de ejecución conforme los datos totales crecían, hasta superarlo en la muestra de 11 millones. En esta muestra, \textit{Dask} fue aproximadamente 17\% más tardado en los tres procesos. Por otro lado, en los procesos que involucran operaciones de preparación de datos (\texttt{flota} y \texttt{elimina\_nulos}), \textit{Dask} mantuvo un mejor desempeño durante las cuatro muestras, con una diferencia de tiempo considerable en \texttt{elimina\_nulos} donde el resultado es un conteo. En el caso de \texttt{flota}, que involucra una agregación después de la eliminación de duplicados, la diferencia no fue muy grande en las muestras de mayor tamaño, llegando a un tiempo adicional de \textit{Spark} de tan solo 1.1\% en la última muestra. En resumen, considero que cuando se superan los 10 millones de registros, \textit{Spark} es más competitivo en el cálculo de tareas de agregación y sin duda en este tipo de tareas cuando la llave de agregación se crea durante el procesamiento, mientas que \textit{Dask} parece ser más rápido en tareas de preparación de datos como eliminación de nulos y duplicados. Por último, en el proceso más complejo y sobre todo que involucra iteraciones, \textit{Dask} es muy superior, por lo que creo que para algoritmos más complejos esta debe ser la herramienta de elección.
	
	\item \textbf{Duración.} Por último, considerando la duración combinada del tiempo de cómputo y escritura, es interesante notar que procesos similares registran tiempos de ejecución total muy distintos en las diferentes muestras, como es el caso de los procesos de agregación \texttt{demoras\_aeropuerto\_origen} y \texttt{demoras\_aeropuerto\_destino}. Estos procesos tienen agregaciones y llaves de agregación muy similares pero difieren en el destino de la escritura que juega un papel muy importante. Algo similar sucede con los procesos \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid}, que debido al destino de escritura muestran dinámicas diferentes. En ambas parejas de procesos, el desempeño de \textit{Spark} mejora respecto a la de \textit{Dask} cuando la escritura es a \textit{MySQL}, mientras que cuando la escritura se hace a \texttt{parquet}, \textit{Dask} sigue registrando tiempos menores de ejecución. Esto a pesar de que \textit{Spark} logró tiempos menores de cómputo. Lo anterior resalta la importancia de la capacidad de escritura de ambos \textit{frameworks}, que se vuelve un factor decisivo al elegir entre uno y otro. Por otro lado, \textit{Dask} demostró una capacidad muy superior en la ejecución del algoritmo iterativo, por lo que considero que es mejor para tareas de procesamiento más complejas. Finalmente, \textit{Dask} sí mantuvo su superioridad en las tareas de preparación de datos, por lo que considero que para este tipo de tareas esta debe ser la herramienta de elección no sólo por que su ejecución es rápida sino por qué también \textit{Dask} demostró tener capacidades de escritura importantes a archivos \texttt{parquet} y este tipo de procesos normalmente involucran la escritura de grandes conjuntos de datos. 
	
\end{itemize}


\newpage

\section{Ambiente en la nube}
\label{section:resultados-ambiente-nube}

Los siguientes resultados fueron obtenidos ejecutando los procesos en el ambiente distribuido en la nube siguiendo la misma metodología. Los resultados y su análisis mantienen la misma estructura que la explicada en el Capítulo \ref{chapter:resultados}. No obstante, debido a que el ambiente en la nube tiene factores adicionales que pueden afectar el desempeño, como la latencia de red para escribir a la base de datos o para transferir datos entre los servidores, se eliminaron las cinco ejecuciones más rápidas y las cinco ejecuciones que más tiempo tomaron. Sin embargo para el proceso \texttt{demoras\_ruta\_aeropuerto} ejecutado en \textit{Dask} con el total de los datos, sólo se mantuvieron 70 ya que la herramienta sólo logró completar 74 de los 100 totales. Por otro lado, en el caso de la ejecución del proceso \texttt{dijkstra} se mantuvo el total de las ejecuciones (50) ya que debido a los largos tiempos de ejecución no fue posible lograr las 100 ejecuciones. 

\subsection{Ejecución en la nube con 10,000 registros}

Las conclusiones más relevantes sobre esta muestra de datos son las siguientes:

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 1,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (32.222,demoras\_aerolinea)
  						(31.762,demoras\_aeropuerto\_destino)
  						(35.356,demoras\_aeropuerto\_origen)
  						(32.320,demoras\_ruta\_aeropuerto)
  						(36.523,demoras\_ruta\_mktid)
  						(124.251,dijkstra)
  						(25.113,elimina\_nulos)
  						(36.574,flota)};  
  
  \addplot[fill=orange] coordinates { (4.782,demoras\_aerolinea)
  						(4.713,demoras\_aeropuerto\_destino)
  						(6.085,demoras\_aeropuerto\_origen)
  						(6.278,demoras\_ruta\_aeropuerto)
  						(9.438,demoras\_ruta\_mktid)
  						(6.676,dijkstra)
  						(3.815,elimina\_nulos)
  						(5.261,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos en el ambiente distribuido con 10,000 registros.}
\label{barras:nube-duracion10K}
\end{figure}
\end{center}


\begin{itemize}
	
	\item \textbf{Robustez.} Al igual que con las muestras más pequeñas de la ejecución local, ambos \textit{frameworks} lograron completar el 100\% de sus ejecuciones.
	
	\item \textbf{Variación.} La tabla \ref{table:nube-duracion10K} muestra que, a excepción del proceso \texttt{dijkstra}, los procesos de \textit{Dask} tuvieron un mayor coeficiente de variación pero también registraron una desviación estándar de aproximadamente un tercio de la registrada por los procesos de \textit{Spark}. Los coeficientes más altos de \textit{Dask} están influenciados por su corto tiempo de ejecución, mientras que \textit{Spark} tiene una variación de aproximadamente 5\% de su duración total, lo que muestra una gran consistencia en la duración de las tareas. Sin embargo, en el caso del proceso \texttt{dijkstra}, \textit{Spark} registró una desviación estándar mucho mayor y también un coeficiente de variación mayor.  También es importante notar que la desviación estándar en todos los casos es menor que 2 segundos, por lo que ambos tienen una desviación muy pequeña. 
	
	\item \textbf{Inicio de la ejecución.} Al observar la tabla \ref{table:nube-otros10K} podemos ver que, en el tiempo de inicio de la ejecución, también \textit{Dask} sigue siendo significativamente más rápido que \textit{Spark}. En el caso de \textit{Dask}, el tiempo de inicio de la ejecución es cercano a 0.025 segundos en casi todos los casos, mientras que en el caso de \textit{Spark} ronda entre 3 y 3.5 segundos.
	
	\item \textbf{Escritura.} Los resultados de la tabla \ref{table:nube-write10K} muestran que, tanto a \textit{MySQL} como archivos \texttt{parquet}, \textit{Dask} tuvo un desempeño superior en la escritura en todos los procesos y con una ventaja especialmente amplia a archivos \texttt{parquet} donde \textit{Spark} fue más de 9 veces más tardado. Además, ambos \textit{frameworks} registraron sus mayores tiempos de escritura al escribir a \textit{MySQL}, con \textit{Spark} siendo entre 180\% y 492\% más tardado y con una diferencia respecto a \textit{Dask} que se reduce conforme crece el tamaño del resultado escrito. 
	
	\item \textbf{Capacidad de cómputo.} En el tiempo de cómputo, con este tamaño de muestra, \textit{Dask} fue muy superior ya que calculó más rápidamente el resultado de todos los procesos, mientras que \textit{Spark} requirió entre 370\% y 1858\% más de tiempo para completar todos los resultados. La diferencia más grande fue en el proceso \texttt{dijkstra} y la menor en los procesos \texttt{demoras\_ruta\_mktid} y \texttt{demoras\_ruta\_aeropuerto}. Esta información se puede revisar en la tabla \ref{table:nube-otros10K}.

	\item \textbf{Duración.} La figura \ref{barras:nube-duracion10K} ilustra la gran diferencia que existe en el tiempo de ejecución de cada proceso de \textit{Dask} contra \textit{Spark}. En la tabla \ref{table:nube-write10K} podemos ver que aunque el tiempo de escritura es superior en \textit{Spark}, esta diferencia no es suficiente para explicar la diferencia tan grande de tiempo en el tiempo global. Además, es interesante notar que mientras los tiempos registrados por \textit{Dask} no son tan diferentes a los de la tabla \ref{table:duracion10K} en el modo local, en el caso de \textit{Spark} estos aumentaron significativamente, lo que sugiere que el \textit{overhead} de este, al usarlo en un ambiente distribuido, es mayor al de \textit{Dask}.
	
\end{itemize}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
                demoras\_aerolinea & dask & 90 & 4.782 & 0.529 & 0.111 & 0.148 & 6.738 \\ % \hline
        demoras\_aerolinea & spark & 90 & 32.222 & 1.592 & 0.049 & 0.148 & 6.738 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 90 & 4.713 & 0.491 & 0.104 & 0.148 & 6.739 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 90 & 31.762 & 1.582 & 0.050 & 0.148 & 6.739 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 90 & 6.085 & 0.478 & 0.079 & 0.172 & 5.810 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 90 & 35.356 & 1.527 & 0.043 & 0.172 & 5.810 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 90 & 6.278 & 0.549 & 0.087 & 0.194 & 5.148 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 90 & 32.320 & 1.668 & 0.052 & 0.194 & 5.148 \\ % \hline
        demoras\_ruta\_mktid & dask & 90 & 9.438 & 0.571 & 0.061 & 0.258 & 3.870 \\ % \hline
        demoras\_ruta\_mktid & spark & 90 & 36.523 & 1.875 & 0.051 & 0.258 & 3.870 \\ % \hline
        dijkstra & dask & 90 & 6.676 & 3.149 & 0.472 & 0.054 & 18.612 \\ % \hline
        dijkstra & spark & 90 & 124.251 & 97.160 & 0.782 & 0.054 & 18.612 \\ % \hline
        elimina\_nulos & dask & 90 & 3.815 & 0.341 & 0.089 & 0.152 & 6.583 \\ % \hline
        elimina\_nulos & spark & 90 & 25.113 & 1.208 & 0.048 & 0.152 & 6.583 \\ % \hline
        flota & dask & 90 & 5.261 & 0.550 & 0.104 & 0.144 & 6.952 \\ % \hline
        flota & spark & 90 & 36.574 & 1.652 & 0.045 & 0.144 & 6.952 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos en el ambiente distribuido con muestra de 10 mil registros.}
    \label{table:nube-duracion10K}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.025 & 4.376 & 6.402 & 0.156 \\ % \hline
        demoras\_aerolinea & spark & 2.617 & 28.015 & 6.402 & 0.156 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.026 & 4.265 & 6.491 & 0.154 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 2.629 & 27.683 & 6.491 & 0.154 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.027 & 4.318 & 6.445 & 0.155 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 2.630 & 27.831 & 6.445 & 0.155 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.025 & 5.923 & 4.715 & 0.212 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 2.490 & 27.925 & 4.715 & 0.212 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.025 & 6.705 & 4.288 & 0.233 \\ % \hline
        demoras\_ruta\_mktid & spark & 2.541 & 28.751 & 4.288 & 0.233 \\ % \hline
        dijkstra & dask & 1.201 & 6.474 & 18.584 & 0.054 \\ % \hline
        dijkstra & spark & 3.119 & 120.315 & 18.584 & 0.054 \\ % \hline
        elimina\_nulos & dask & 0.027 & 3.815 & 6.583 & 0.152 \\ % \hline
        elimina\_nulos & spark & 2.633 & 25.113 & 6.583 & 0.152 \\ % \hline
        flota & dask & 0.025 & 4.288 & 7.185 & 0.139 \\ % \hline
        flota & spark & 2.532 & 30.810 & 7.185 & 0.139 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos en el ambiente distribuido con muestra de 10 mil registros.}
    \label{table:nube-otros10K}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 4.207 & 12135 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.406 & 12135 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 4.079 & 22144 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 0.448 & 22144 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 7.525 & 22086 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 1.767 & 22086 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 4.395 & 41147 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 0.355 & 41147 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 7.772 & 38909 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 2.733 & 38909 & 11 \\ % \hline
        dijkstra & spark & mysql & 3.936 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.202 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 5.764 & 12135 & 6 \\ % \hline
        flota & dask & mysql & 0.973 & 12135 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura y tamaño del resultado en el ambiente distribuido con muestra de 10 mil registros.}
    \label{table:nube-write10K}
\end{table}

En suma, con la muestra de datos más pequeña, \textit{Dask} es superior en: el inicio de la ejecución, el tiempo de escritura a ambos destinos, el cálculo de los procesos y la ejecución global, con una amplia diferencia en las últimas dos. Además, es importante destacar que el desempeño de \textit{Dask} no se vió tan afectado como el de \textit{Spark} al pasar al ambiente distribuido. Por otro lado, \textit{Spark} tuvo menores coeficientes de variación pero que fueron acompañados de una mayor duración, por lo que la variación en segundos fue mayor a la de \textit{Dask} pero menor en proporción al tiempo de duración promedio. Por último, en la robustez de los procesos ambos tuvieron resultados adecuados ya que completaron el 100\% de las tareas.

\subsection{Ejecución en la nube con 100,000 registros}

Las conclusiones más relevantes sobre esta muestra de datos son las siguientes:

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 1,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (29.759,demoras\_aerolinea)
  						(29.403,demoras\_aeropuerto\_destino)
  						(33.167,demoras\_aeropuerto\_origen)
  						(31.396,demoras\_ruta\_aeropuerto)
  						(37.790,demoras\_ruta\_mktid)
  						(111.238,dijkstra)
  						(22.884,elimina\_nulos)
  						(35.362,flota)};  
  
  \addplot[fill=orange] coordinates { (4.388,demoras\_aerolinea)
  						(4.520,demoras\_aeropuerto\_destino)
  						(10.849,demoras\_aeropuerto\_origen)
  						(7.721,demoras\_ruta\_aeropuerto)
  						(22.635,demoras\_ruta\_mktid)
  						(9.692,dijkstra)
  						(3.163,elimina\_nulos)
  						(6.205,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos en el ambiente distribuido con 100,000 registros.}
\label{barras:nube-duracion100K}
\end{figure}
\end{center}


\begin{itemize}
	
	\item \textbf{Robustez.} Con la muestra de 100,000 registros, ambos \textit{frameworks} lograron completar el 100\% de sus ejecuciones.
	
	\item \textbf{Variación.} La tabla \ref{table:nube-duracion100K} muestra que, en la mayoría de los procesos, \textit{Spark} tuvo una menor variación relativa al tiempo total de ejecución ya que su coeficiente de variación fue de menos de la mitad del registrado por \textit{Dask}, con la excepción del proceso \texttt{dijkstra}. Sin embargo, en tiempo, \textit{Dask} registró una menor variación aunque esta diferencia fue menor a un segundo (a excepción del proceso \texttt{dijkstra}). Es importante notar que la variación no es muy diferente entre ambos \textit{frameworks} a pesar de que el tiempo de duración de \textit{Spark} es significativamente mayor. También es importante notar que la variación en el proceso iterativo es la mayor en ambos procesos, pero la registrada por \textit{Spark} es mucho mayor.
	
	\item \textbf{Inicio de la ejecución.} Los resultados expuestos en la tabla \ref{table:nube-otros100K} muestran que el tiempo de inicio de la ejecución de \textit{Dask} sigue siendo menor al de \textit{Spark}, registrado una diferencia cercana a 2 segundos en la mayoría de los procesos, con la excepción de \texttt{dijkstra} donde la diferencia es un poco menor (cercana 1.3 segundos) y también favorable a \textit{Dask}. 
	
	\item \textbf{Escritura.} Al aumentar el tamaño de la muestra, podemos ver que el tiempo de escritura de \textit{Dask} a archivos \texttt{parquet} aún es menor que el registrado por \textit{Spark}, como se expone en la tabla \ref{table:nube-write100K}. Los resultados muestran que el tiempo de escritura de \textit{Spark} a archivos \texttt{parquet} es de aproximadamente 8.8, 5.9 y 4.5 veces el registrado por \textit{Dask} en los procesos \texttt{demoras\_aerolinea}, \texttt{demoras\_aeropuerto\_destino} y \texttt{demoras\_ruta\_aeropuerto}, respectivamente. Adicionalmente, es importante notar que la razón de duración de la escritura de \textit{Spark} entre la de \textit{Dask} se reduce conforme crece el número de registros que escribe. Por otra parte, en el caso de la escritura a \textit{MySQL}, el tiempo de \textit{Spark} es 155\% superior en el proceso \texttt{flota}, 12\% superior en el proceso \texttt{demoras\_aeropuerto\_origen} y 42\% inferior en el proceso \texttt{demoras\_ruta\_mktid}. En este caso, el desempeño de \textit{Spark} respecto a \textit{Dask} también mejora conforme aumenta el número de registros que se escriben. También vale la pena resaltar que el tiempo de escritura siempre fue menor al 30\% del tiempo total en el caso de \textit{Spark}, mientras que en el caso de \textit{Dask}, este fue mayor al 60\% en los procesos \texttt{demoras\_ruta\_mktid} y \texttt{demoras\_aeropuerto\_origen} y 36\% en el proceso \texttt{flota}. Estos tres procesos fueron en los que la escritura significó la mayor proporción del tiempo total de ejecución y coinciden con que la escritura se hace a \textit{MySQL}. Por último, hay que tomar en cuenta que el tiempo de ejecución de \textit{Spark} fue significativamente mayor, lo que influye en que la proporción del tiempo de escritura sea menor.
	
	\item \textbf{Capacidad de cómputo.} La tabla \ref{table:nube-otros100K} muestra que \textit{Dask} siempre tuvo un desempeño superior en el tiempo de cálculo del resultado con diferencias de más de 18 segundos en todos los procesos y con \textit{Spark} siendo entre 270\% y 650\% más tardado en los procesos no iterativos y 1000\% más tardado en el proceso \texttt{dijkstra}. También es importante notar que los procesos en los que la diferencia fue menor corresponden a los procesos que requieren generar una nueva llave antes de hacer la agregación.
	
	\item \textbf{Duración.} Al considerar el tiempo de duración total (resumido en la figura \ref{barras:nube-duracion100K}) se puede observar que el desempeño de \textit{Dask} es muy superior en todos los procesos cuando comparamos el tiempo total de duración. Además, en la tabla \ref{table:nube-duracion100K} podemos ver que con este tamaño de muestra, y exceptuando el proceso \texttt{demoras\_rutas\_mktid}, los procesos ejecutados en \textit{Dask} tardaron menos del 33\% del tiempo requerido por \textit{Spark} para completar el proceso correspondiente, esto principalmente influenciado por su mayor capacidad para calcular el proceso pero también apoyado por su capacidad de escritura que es mejor que la de \textit{Spark} en casi todos los casos. Esto último es evidente cuando observamos que la menor diferencia se presentó en los procesos que escriben un gran número de registros a \textit{MySQL} y en los cuales el tiempo de escritura explica una mayor proporción del tiempo total.
	
En resumen, esta ejecución muestra que \textit{Dask} tuvo un mejor desempeño en cuatro de los rubros. Primero, el tiempo de ejecución total, fue menor para todos los procesos; segundo, el tiempo de cómputo del resultado, donde la diferencia fue importante en todos los procesos y favorable a \textit{Dask}; tercero, el inicio de la ejecución fue menor para \textit{Dask} en todos los procesos y cuarto, la escritura, donde la superioridad fue muy clara en los procesos con \texttt{parquet}. Sin embargo, en el proceso de escritura a \textit{MySQL} con mayor número de registros, \textit{Spark} logró tiempos menores a los registrados por \textit{Dask}. En el caso de la variación, \textit{Spark} fue más constante en sus tiempos de ejecución, pero estos fueron más grandes de los de \textit{Dask}, cuya desviación estándar en segundos fue menor que la de \textit{Spark}. Y por último, en el rubro de robustez, ambos lograron un resultado satisfactorio ya que ejecutaron correctamente el 100\% de sus ejecuciones.
	
\end{itemize}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 90 & 4.388 & 0.304 & 0.069 & 0.147 & 6.782 \\ % \hline
        demoras\_aerolinea & spark & 90 & 29.759 & 0.596 & 0.02 & 0.147 & 6.782 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 90 & 4.52 & 0.321 & 0.071 & 0.154 & 6.505 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 90 & 29.403 & 0.561 & 0.019 & 0.154 & 6.505 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 90 & 10.849 & 0.321 & 0.03 & 0.327 & 3.057 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 90 & 33.167 & 0.563 & 0.017 & 0.327 & 3.057 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 90 & 7.721 & 0.492 & 0.064 & 0.246 & 4.066 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 90 & 31.396 & 0.57 & 0.018 & 0.246 & 4.066 \\ % \hline
        demoras\_ruta\_mktid & dask & 90 & 22.635 & 0.709 & 0.031 & 0.599 & 1.67 \\ % \hline
        demoras\_ruta\_mktid & spark & 90 & 37.79 & 0.769 & 0.02 & 0.599 & 1.67 \\ % \hline
        dijkstra & dask & 90 & 9.692 & 2.618 & 0.27 & 0.087 & 11.477 \\ % \hline
        dijkstra & spark & 90 & 111.238 & 105.217 & 0.946 & 0.087 & 11.477 \\ % \hline
        elimina\_nulos & dask & 90 & 3.163 & 0.122 & 0.039 & 0.138 & 7.235 \\ % \hline
        elimina\_nulos & spark & 90 & 22.884 & 0.436 & 0.019 & 0.138 & 7.235 \\ % \hline
        flota & dask & 90 & 6.205 & 0.193 & 0.031 & 0.175 & 5.699 \\ % \hline
        flota & spark & 90 & 35.362 & 0.744 & 0.021 & 0.175 & 5.699 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos en el ambiente distribuido con muestra de 100 mil registros.}
    \label{table:nube-duracion100K}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline        demoras\_aerolinea & dask & 0.022 & 3.969 & 6.562 & 0.152 \\ % \hline
        demoras\_aerolinea & spark & 2.143 & 26.045 & 6.562 & 0.152 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.022 & 3.887 & 6.607 & 0.151 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 2.123 & 25.683 & 6.607 & 0.151 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.022 & 3.939 & 6.451 & 0.155 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 2.088 & 25.410 & 6.451 & 0.155 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.022 & 6.574 & 4.000 & 0.250 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 2.094 & 26.294 & 4.000 & 0.250 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.021 & 7.234 & 3.785 & 0.264 \\ % \hline
        demoras\_ruta\_mktid & spark & 2.090 & 27.381 & 3.785 & 0.264 \\ % \hline
        dijkstra & dask & 1.021 & 9.518 & 11.303 & 0.088 \\ % \hline
        dijkstra & spark & 2.341 & 107.585 & 11.303 & 0.088 \\ % \hline
        elimina\_nulos & dask & 0.022 & 3.163 & 7.235 & 0.138 \\ % \hline
        elimina\_nulos & spark & 2.103 & 22.884 & 7.235 & 0.138 \\ % \hline
        flota & dask & 0.022 & 3.957 & 7.487 & 0.134 \\ % \hline
        flota & spark & 2.106 & 29.628 & 7.487 & 0.134 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos en el ambiente distribuido con muestra de 100 mil registros.}
    \label{table:nube-otros100K}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 3.714 & 49439 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.419 & 49439 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 3.720 & 116746 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 0.633 & 116746 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 7.757 & 116656 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 6.910 & 116656 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 5.102 & 297814 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 1.147 & 297814 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 10.409 & 267505 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 15.401 & 267505 & 11 \\ % \hline
        dijkstra & spark & mysql & 3.653 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.174 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 5.734 & 49439 & 6 \\ % \hline
        flota & dask & mysql & 2.248 & 49439 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura y tamaño del resultado en segundos en el ambiente distribuido con muestra de 100 mil registros.}
    \label{table:nube-write100K}
\end{table}


\subsection{Ejecución en la nube con 1,000,000 de registros}

Las conclusiones más importantes de la ejecución con 1,000,000 de registros se listan a continuación.

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 0.3,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (35.17,demoras\_aerolinea)
  						(36.137,demoras\_aeropuerto\_destino)
  						(45.969,demoras\_aeropuerto\_origen)
  						(46.432,demoras\_ruta\_aeropuerto)
  						(91.062,demoras\_ruta\_mktid)
  						(487.518,dijkstra)
  						(26.031,elimina\_nulos)
  						(40.662,flota)};  
  
  \addplot[fill=orange] coordinates { (7.515,demoras\_aerolinea)
  						(8.209,demoras\_aeropuerto\_destino)
  						(32.697,demoras\_aeropuerto\_origen)
  						(24.123,demoras\_ruta\_aeropuerto)
  						(102.73,demoras\_ruta\_mktid)
  						(56.549,dijkstra)
  						(4.582,elimina\_nulos)
  						(12.305,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos en el ambiente distribuido con 1,000,000 de registros.}
\label{barras:nube-duracion1M}
\end{figure}
\end{center}

\begin{itemize}
	\item \textbf{Robustez.} Con este tamaño de muestra se completaron el 100\% de las ejecuciones de forma exitosa en todos los procesos, por lo que ambos alcanzaron un resultado satisfactorio.

	\item \textbf{Variación.} En la tabla \ref{table:nube-duracion1M} podemos ver que \textit{Dask} registró un menor coeficiente de variación en los procesos \texttt{demoras\_aeropuerto\_origen}, \texttt{demoras\_ruta\_mktid} y \texttt{dijkstra} respecto al de \textit{Spark}. Estos procesos coinciden con los tres procesos de mayor duración de \textit{Dask}. Por otro lado, el coeficiente registrado por \textit{Spark} es menor en el resto de los procesos pero también es menor el tiempo de ejecución de \textit{Dask}, lo cual puede influenciar el coeficiente de variación alto. Por otra parte, si consideramos la desviación estándar podemos ver que la variación es menor en \textit{Dask} en la mayoría de los procesos con la excepción de \texttt{demoras\_ruta\_aeropuerto}, proceso que implica escritura a \texttt{parquet} y creación de una nueva llave.
	
	\item \textbf{Inicio de la ejecución.} La información resumida en la tabla \ref{table:nube-otros1M} muestra que, una vez más, \textit{Dask} tuvo un menor tiempo de inicio en todos los procesos y tuvo una menor diferencia en el proceso \texttt{dijkstra}.
	
	\item \textbf{Escritura.} Observando la tabla \ref{table:nube-write1M} podemos ver que el tiempo de escritura a archivos \texttt{parquet} sigue siendo menor al ejecutar los procesos con \textit{Dask} pero ya no es más rápido al escribir a \textit{MySQL}. El aumento en el número de registros, mejoró el desempeño de \textit{Spark} respecto a \textit{Dask} en la escritura a \textit{MySQL} superando a este en dos de los tres procesos. Este tamaño del conjunto de datos parece mostrar que mientras que el desempeño de \textit{Dask} se mantiene al escribir a \texttt{parquet} un mayor número de registros, esto no sucede al escribir a \textit{MySQL}. Por otra parte, al aumentar el número de registros también aumentó la proporción del tiempo total que los \textit{frameworks} dedican a la escritura, este porcentaje alcanzó cantidades mayores a 77\% en dos procesos en el caso de \textit{Dask}, mientras que en el caso de \textit{Spark} el tiempo de escritura nunca fue mayor al 57\% del tiempo total. También cabe mencionar que tanto \textit{Dask} como \textit{Spark} alcanzaron el mayor tiempo de escritura y proporción del tiempo total en el proceso \texttt{demoras\_ruta\_mktid} con 81.822 y 79.6\% respectivamente para \textit{Dask} y 51.365 y 56.4\% para \textit{Spark}. Este proceso escribe a \textit{MySQL} y tiene el segundo mayor número de registros totales (poco más de 1 millón).
	
	\item \textbf{Capacidad de cómputo.} En este rubro, \textit{Dask} superó a \textit{Spark} en todos los procesos con especial diferencia de tiempo en el proceso iterativo y el proceso \texttt{elimina\_nulos}, que es el que ambas herramientas ejecutan más rápido. Por el contrario, los dos procesos con menor diferencia de tiempo entre ambos \textit{frameworks} son aquellos que implican una agregación con una nueva llave y fueron entre 58\% y 90\% más tardados en \textit{Spark}, lo cual implica una reducción en la diferencia respecto a la muestra anterior. Además es importante notar que el tiempo de cómputo de \textit{Spark} ha aumentado poco respecto a las muestras anteriores, lo que no es el caso de \textit{Dask}.
	
	\item \textbf{Duración.} Al considerar la duración total, representada en la figura \ref{barras:nube-duracion1M} podemos ver que \textit{Dask} sigue teniendo menores tiempos de ejecución en la mayoría de los procesos pero que esta diferencia se redujo significativamente. Además, con 1 millón de registros podemos apreciar que, en el proceso \texttt{demoras\_ruta\_mktid}, \textit{Spark} es más rápido que \textit{Dask} y esto está influenciado principalmente por el mejor tiempo de escritura a \textit{MySQL} de \textit{Spark}. La tabla \ref{table:nube-duracion1M} permite ver que este proceso fue un 12.8\% más tardado al ejecutarse con \textit{Dask} que con \textit{Spark}. A pesar de que la diferencia se redujo, \textit{Dask} sigue siendo más rápido que \textit{Spark} en casi todos los procesos y en cinco de ellos el tiempo que requiere \textit{Dask} para completarlos es menos del 30\% del que le toma a \textit{Spark}, lo cual muestra que prevalece la ventaja de \textit{Dask} en el tiempo de ejecución total.
\end{itemize}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 90 & 7.515 & 0.536 & 0.071 & 0.214 & 4.68 \\ % \hline
        demoras\_aerolinea & spark & 90 & 35.17 & 1.701 & 0.048 & 0.214 & 4.68 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 90 & 8.209 & 0.592 & 0.072 & 0.227 & 4.402 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 90 & 36.137 & 1.671 & 0.046 & 0.227 & 4.402 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 90 & 32.697 & 1.101 & 0.034 & 0.711 & 1.406 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 90 & 45.969 & 2.322 & 0.051 & 0.711 & 1.406 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 90 & 24.123 & 2.082 & 0.086 & 0.52 & 1.925 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 90 & 46.432 & 1.655 & 0.036 & 0.52 & 1.925 \\ % \hline
        demoras\_ruta\_mktid & dask & 90 & 102.73 & 2.755 & 0.027 & 1.128 & 0.886 \\ % \hline
        demoras\_ruta\_mktid & spark & 90 & 91.062 & 7.062 & 0.078 & 1.128 & 0.886 \\ % \hline
        dijkstra & dask & 90 & 56.549 & 8.287 & 0.147 & 0.116 & 8.621 \\ % \hline
        dijkstra & spark & 90 & 487.518 & 807.132 & 1.656 & 0.116 & 8.621 \\ % \hline
        elimina\_nulos & dask & 90 & 4.582 & 0.497 & 0.109 & 0.176 & 5.681 \\ % \hline
        elimina\_nulos & spark & 90 & 26.031 & 1.4 & 0.054 & 0.176 & 5.681 \\ % \hline
        flota & dask & 90 & 12.305 & 0.581 & 0.047 & 0.303 & 3.305 \\ % \hline
        flota & spark & 90 & 40.662 & 1.601 & 0.039 & 0.303 & 3.305 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos en el ambiente distribuido con muestra de 1 millón de registros.}
    \label{table:nube-duracion1M}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.026 & 7.105 & 4.371 & 0.229 \\ % \hline
        demoras\_aerolinea & spark & 2.558 & 31.058 & 4.371 & 0.229 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.026 & 7.281 & 4.229 & 0.236 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 2.502 & 30.789 & 4.229 & 0.236 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.026 & 7.252 & 4.247 & 0.235 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 2.573 & 30.802 & 4.247 & 0.235 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.029 & 21.35 & 1.58 & 0.633 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 2.564 & 33.736 & 1.58 & 0.633 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.03 & 20.908 & 1.899 & 0.527 \\ % \hline
        demoras\_ruta\_mktid & spark & 2.536 & 39.697 & 1.899 & 0.527 \\ % \hline
        dijkstra & dask & 1.103 & 56.34 & 8.589 & 0.116 \\ % \hline
        dijkstra & spark & 2.558 & 483.926 & 8.589 & 0.116 \\ % \hline
        elimina\_nulos & dask & 0.026 & 4.582 & 5.681 & 0.176 \\ % \hline
        elimina\_nulos & spark & 2.582 & 26.031 & 5.681 & 0.176 \\ % \hline
        flota & dask & 0.026 & 9.103 & 3.783 & 0.264 \\ % \hline
        flota & spark & 2.521 & 34.439 & 3.783 & 0.264 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos en el ambiente distribuido con muestra de 1 millón de registros.}
    \label{table:nube-otros1M}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 4.112 & 76717 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.41 & 76717 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 5.348 & 436411 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 0.928 & 436411 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 15.167 & 436681 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 25.445 & 436681 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 12.696 & 1619826 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 2.773 & 1619826 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 51.365 & 1430282 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 81.822 & 1430282 & 11 \\ % \hline
        dijkstra & spark & mysql & 3.592 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.209 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 6.223 & 76717 & 6 \\ % \hline
        flota & dask & mysql & 3.202 & 76717 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura y tamaño del resultado en segundos en el ambiente distribuido con muestra de 1 millón de registros.}
    \label{table:nube-write1M}
\end{table}

Resumiendo, \textit{Dask} sigue siendo superior en cuatro rubros aunque la diferencia de desempeño entre ambas herramientas se ha reducido en muchos de ellos. Estos cuatro rubros son: en primer lugar, el inicio de la ejecución donde la tendencia se mantuvo; segundo, el tiempo de cómputo donde la diferencia fue menor respecto a la muestra anterior en algunos de los procesos pero \textit{Spark} siguió registrando tiempos superiores en todos los procesos; tercero, en el tiempo total donde \textit{Dask} fue más rápido en siete de los ocho procesos y en cinco de ellos requirió menos del 31\% del tiempo registrado por \textit{Spark} y, cuarto, en la variación, donde \textit{Dask} registró una menor desviación estándar en siete de los ocho procesos y mejoró también el coeficiente de variación, siendo este menor al de \textit{Spark} en tres de los ocho procesos. Por otro lado, \textit{Spark} tuvo un mejor desempeño en la escritura de resultados grandes a \textit{MySQL} pero \textit{Dask} mantuvo una ventaja clara en la escritura a \texttt{parquet}. Por último, ambos \textit{frameworks} tuvieron una robustez satisfactoria ya que completaron el total de sus ejecuciones de forma exitosa.


\subsection{Ejecución en la nube con 11,000,000 de registros}

Después de analizar los resultados con 11,000,000 de registros se obtuvieron las siguientes conclusiones:

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 0.3,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (36.27,demoras\_aerolinea)
  						(42.881,demoras\_aeropuerto\_destino)
  						(65.451,demoras\_aeropuerto\_origen)
  						(94.119,demoras\_ruta\_aeropuerto)
  						(284.435,demoras\_ruta\_mktid)
  						(600.708,dijkstra)
  						(26.382,elimina\_nulos)
  						(42.84,flota)};  
  
  \addplot[fill=orange] coordinates { (12.453,demoras\_aerolinea)
  						(14.204,demoras\_aeropuerto\_destino)
  						(70.983,demoras\_aeropuerto\_origen)
  						(93.219,demoras\_ruta\_aeropuerto)
  						(488.529,demoras\_ruta\_mktid)
  						(225.863,dijkstra)
  						(6.357,elimina\_nulos)
  						(17.272,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
\end{tikzpicture}
\caption{Duración en segundos de los procesos en el ambiente distribuido con 11,000,000 de registros.}
\label{barras:nube-duracion10M}
\end{figure}
\end{center}

\begin{itemize}
	\item \textbf{Robustez.} Con esta muestra de datos, \textit{Dask} presentó problemas en la ejecución de los procesos \texttt{demoras\_ruta\_mktid} y \texttt{demoras\_ruta\_aeropuerto} por falta de memoria. Esto sucedía después de aproximadamente cinco ejecuciones de dichos procesos y era causado por el caché no eliminado por \textit{Dask} de la ejecución anterior a pesar de que esta ya había finalizado. Después de aproximadamente cinco ejecuciones, la memoria disponible se reducía lo suficiente como para evitar la ejecución del proceso. Además, el proceso no fallaba sino que se mantenía ejecutando por más de diez veces la duración normal del proceso por lo que se optó por interrumpirlo. La solución para evitar este comportamiento fue reiniciar los \texttt{dask-workers} cuando el caché aumentaba (normalmente tres iteraciones) y así se evitaban los errores de falta de memoria. Sin embargo, esto provocó que un monitoreo constante de la memoria disponible y un reinicio manual de los \texttt{dask-workers} fuera necesario, lo cual no es conveniente para aplicaciones automáticas y con ejecución periódica. Este problema no se presentó en \textit{Spark} que ejecutó los procesos mencionados sin problemas y sin necesidad de intervención. Por otro lado, al ejecutar el proceso \texttt{dijkstra} en \textit{Spark}, aparecieron algunas ejecuciones que aunque no mostraban errores ni interrupciones en la ejecución, tardaban más de una hora en terminar por lo que fueron interrumpidos. No obstante, no considero que estos fueran a fallar ya que el uso de recursos y el avance del algoritmo mostraba condiciones normales. En cuánto a los otros procesos, tanto \textit{Dask} como \textit{Spark} lograron completar el 100\% de las ejecuciones sin incidentes.

	\item \textbf{Variación.} Al aumentar la muestra a 11 millones de registros, la consistencia del tiempo de ejecución de \textit{Dask} se hizo más evidente, ya que el coeficiente de variación registrado por este fue mayor sólo en dos de los ocho procesos y en uno de ellos está fuertemente influenciado por el corto tiempo de ejecución (\texttt{elimina\_nulos}), además, en la desviación estándar el valor también fue menor en siete de ocho procesos, siendo la única excepción el proceso \texttt{demoras\_ruta\_aeropuerto} dónde la diferencia es menor a un segundo y en el que el coeficiente de variación es menor del 3.5\% para ambos \textit{frameworks}. Esta información se puede consultar en la tabla \ref{table:nube-duracion10M}.
	
	\item \textbf{Inicio de la ejecución.} La información correspondiente a este rubro está resumida en la tabla \ref{table:nube-otros10M} y podemos ver que la tendencia se mantiene respecto a las muestras anteriores. \textit{Dask} sigue teniendo un inicio significativamente más rápido pero el tiempo de inicio no ha incrementado mucho respecto a muestras anteriores para ninguno de los \textit{frameworks}.
	
	\item \textbf{Escritura.} La tabla \ref{table:nube-write10M} permite ver que en la escritura de resultados grandes a \textit{MySQL}, \textit{Spark} aumentó la diferencia respecto a \textit{Dask} significativamente. No obstante, para resultados de menor tamaño, \textit{Dask} sigue siendo más rápido en la escritura a la base de datos. Por otro lado, en la escritura a \texttt{parquet}, \textit{Dask} mantiene un mejor desempeño a pesar de que el tamaño del resultado es mayor a 8 millones de registros. Sin embargo, también es interesante notar que la diferencia entre ambas herramientas en la escritura a \texttt{parquet} en el proceso con mayor número de registros es menor que en aquellos procesos con un resultado más pequeño, esto se ve con los procesos  \texttt{demoras\_aerolinea}, \texttt{demoras\_aeropuerto\_destino} y \texttt{demoras\_ruta\_aeropuerto} en los que el tamaño del resultado es aproximadamente 78,000, 1 millón y 8 millones y los tiempos registrados por \textit{Spark} son 9.56, 6.35 y 5.08 veces los de \textit{Dask}, respectivamente. Esto sugiere que \textit{Spark} se hace más competitivo conforme crece el número de registros a escribir, aunque \textit{Dask} sigue teniendo una ventaja amplia cuando la escritura es a \texttt{parquet}. También hay que considerar que en esta muestra el tiempo de escritura ahora toma más tiempo, en el caso de \textit{Spark} tres de los procesos dedican más del 50\% del tiempo total a la escritura mientras que en el caso de \textit{Dask}, en dos procesos la proporción es 79\% o superior.
	
	\item \textbf{Capacidad de cómputo.} Al observar los datos presentados en la tabla \ref{table:nube-otros10M}, podemos ver que el tiempo de cómputo de \textit{Dask} es menor en todos los procesos a excepción de los que requieren una agregación con una nueva llave (\texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid}), dónde a \textit{Spark} le toma menos del 47\% del tiempo que a \textit{Dask} para completar el cómputo del resultado. En los demás casos, \textit{Dask} requiere menos del 40\% del tiempo que \textit{Spark} para completarlo. 
	
	\item \textbf{Duración.} Al considerar el tiempo total, representado en la figura \ref{barras:nube-duracion10M} podemos ver que los procesos que involucran una escritura de datos a \textit{MySQL} de más de un millón de registros (\texttt{demoras\_ruta\_mktid} y \texttt{demoras\_aeropuerto\_origen}) fueron más rápidos en \textit{Spark} y, en el caso del segundo, esto a pesar de un tiempo de cómputo más rápido de \textit{Dask} (el 40\% del necesario para completarlo en \textit{Spark}), por lo que la mayor ventaja de \textit{Spark} parece ser la escritura a \textit{MySQL}. Por otro lado, el proceso \texttt{demoras\_ruta\_aeropuerto} es más rápido en \textit{Dask} a pesar de que el tiempo de cómputo que requirió fue 127\% mayor que el que requirió \textit{Spark}, por lo que su ventaja yace en la velocidad de escritura a \texttt{parquet}. En el resto de los procesos el tiempo de ejecución total de \textit{Spark} es entre 148\% y 315\% superior al de \textit{Dask}, por lo que cuando los procesos no involucran escritura a \textit{MySQL} de más de un millón de datos o agregación con una llave creada durante el proceso \textit{Dask} sigue teniendo un desempeño muy superior.
	
\end{itemize}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
                demoras\_aerolinea & dask & 90 & 12.453 & 0.584 & 0.047 & 0.343 & 2.913 \\ % \hline
        demoras\_aerolinea & spark & 90 & 36.27 & 1.811 & 0.05 & 0.343 & 2.913 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 90 & 14.204 & 0.513 & 0.036 & 0.331 & 3.019 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 90 & 42.881 & 1.817 & 0.042 & 0.331 & 3.019 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 90 & 70.983 & 2.942 & 0.041 & 1.085 & 0.922 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 90 & 65.451 & 4.296 & 0.066 & 1.085 & 0.922 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 90 & 93.219 & 3.162 & 0.034 & 0.99 & 1.01 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 90 & 94.119 & 2.193 & 0.023 & 0.99 & 1.01 \\ % \hline
        demoras\_ruta\_mktid & dask & 90 & 488.529 & 22.185 & 0.045 & 1.718 & 0.582 \\ % \hline
        demoras\_ruta\_mktid & spark & 90 & 284.435 & 165.896 & 0.583 & 1.718 & 0.582 \\ % \hline
        dijkstra & dask & 50 & 225.863 & 40.147 & 0.178 & 0.376 & 2.66 \\ % \hline
        dijkstra & spark & 47 & 600.708 & 1062.603 & 1.769 & 0.376 & 2.66 \\ % \hline
        elimina\_nulos & dask & 90 & 6.357 & 0.57 & 0.09 & 0.241 & 4.15 \\ % \hline
        elimina\_nulos & spark & 90 & 26.382 & 1.425 & 0.054 & 0.241 & 4.15 \\ % \hline
        flota & dask & 90 & 17.272 & 0.6 & 0.035 & 0.403 & 2.48 \\ % \hline
        flota & spark & 90 & 42.84 & 1.883 & 0.044 & 0.403 & 2.48 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos en el ambiente distribuido con muestra de 11 millones de registros.}
    \label{table:nube-duracion10M}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.025 & 11.932 & 2.622 & 0.381 \\ % \hline
        demoras\_aerolinea & spark & 2.447 & 31.287 & 2.622 & 0.381 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.025 & 12.519 & 2.57 & 0.389 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 2.418 & 32.179 & 2.57 & 0.389 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.024 & 12.675 & 2.555 & 0.391 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 2.424 & 32.389 & 2.555 & 0.391 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.021 & 81.762 & 0.439 & 2.278 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 2.504 & 35.899 & 0.439 & 2.278 \\ % \hline
        demoras\_ruta\_mktid & dask & 0.024 & 98.781 & 0.462 & 2.165 \\ % \hline
        demoras\_ruta\_mktid & spark & 2.803 & 45.627 & 0.462 & 2.165 \\ % \hline
        dijkstra & dask & 1.148 & 225.615 & 2.646 & 0.378 \\ % \hline
        dijkstra & spark & 2.818 & 596.916 & 2.646 & 0.378 \\ % \hline
        elimina\_nulos & dask & 0.024 & 6.357 & 4.15 & 0.241 \\ % \hline
        elimina\_nulos & spark & 2.516 & 26.382 & 4.15 & 0.241 \\ % \hline
        flota & dask & 0.024 & 14.068 & 2.626 & 0.381 \\ % \hline
        flota & spark & 2.492 & 36.939 & 2.626 & 0.381 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos en el ambiente distribuido con muestra de 11 millones de registros.}
    \label{table:nube-otros10M}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
                demoras\_aerolinea & spark & parquet & 4.983 & 78113 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.521 & 78113 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 10.702 & 1042066 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 1.685 & 1042066 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 33.062 & 1041665 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 58.308 & 1041665 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 58.22 & 8361958 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 11.457 & 8361958 & 11 \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 238.808 & 6824834 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & mysql & 389.748 & 6824834 & 11 \\ % \hline
        dijkstra & spark & mysql & 3.792 & Variable & Variable \\ % \hline
        dijkstra & dask & mysql & 0.248 & Variable & Variable \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 5.901 & 78113 & 6 \\ % \hline
        flota & dask & mysql & 3.204 & 78113 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura en segundos y tamaño del resultado en el ambiente distribuido con muestra de 11 millones de registros.}
    \label{table:nube-write10M}
\end{table}

En suma, al ejecutar los procesos con la muestra de 11 millones de datos podemos ver que \textit{Spark} superó a \textit{Dask} en la escritura de grandes cantidades de datos a \textit{MySQL}. También fue superior en la robustez, ya que no requirió de intervención o monitoreo para completar los procesos más intensivos en memoria y tuvo una buena administración de los datos en caché a través de las diferentes ejecuciones. Por el contrario, \textit{Dask} fue más consistente en la duración de la mayoría de los procesos y tuvo variaciones pequeñas incluso en aquellos procesos de mayor duración, mientras que \textit{Spark} experimentó grandes variaciones en procesos de alta duración. Adicionalmente, el desempeño de \textit{Dask} siguió superando al de \textit{Spark} cuando se trató de escribir a \texttt{parquet} y en el tiempo de inicio de la ejecución. En el rubro de capacidad de cómputo, \textit{Dask} fue especialmente superior en los procesos que no implican agregación con una nueva llave, procesos en los cuáles el tiempo de \textit{Spark} fue de menos de la mitad que el de \textit{Dask}. Por último, en la duración total \textit{Spark} superó a \textit{Dask} en dos procesos debido a su mejor desempeño en escritura a \textit{MySQL} y estuvo muy cerca en un tercero influenciado por el menor tiempo de cómputo, sin embargo, en el resto \textit{Dask} requirió menos del 41\% del tiempo que \textit{Spark}, por lo que sigue siendo más competitivo en general. 



\subsection{Ejecución en la nube con el total de registros}

Las conclusiones más importantes de la ejecución con el total de los registros (80,345,298) se listan a continuación.

\begin{center}
\begin{figure}
\begin{tikzpicture}
  \begin{axis}[
    xbar,
    y axis line style = { opacity = 0 },
    axis x line       = none,
    y                 = 30,
    x                 = 0.2,
    legend style={at={(0.95,0.25)}},
    clip              = false,
    tickwidth         = 0.1pt,
    ytick             = data,
    enlarge y limits  = 0.02,
    enlarge x limits  = 0.02,
    symbolic y coords = {demoras\_aerolinea, demoras\_aeropuerto\_destino, demoras\_aeropuerto\_origen, demoras\_ruta\_aeropuerto, demoras\_ruta\_mktid, dijkstra, elimina\_nulos, flota},
    nodes near coords,
  ]
  
  \addplot[fill=gray] coordinates { (84.014,demoras\_aerolinea)
  						(249.494,demoras\_aeropuerto\_destino)
  						(245.044,demoras\_aeropuerto\_origen)
  						(290.496,demoras\_ruta\_aeropuerto)
  						(815.236,demoras\_ruta\_mktid)
  						(34.642,elimina\_nulos)
  						(77.208,flota)};  
  
  \addplot[fill=orange] coordinates { (61.23,demoras\_aerolinea)
  						(68.185,demoras\_aeropuerto\_destino)
  						(150.533,demoras\_aeropuerto\_origen)
  						(615.653,demoras\_ruta\_aeropuerto)
  						(22.807,elimina\_nulos)
  						(97.55,flota)};
                         
  \legend{Spark, Dask}
  \end{axis}
  \coordinate (A) at (1.75,4.6);
  \coordinate (B) at (-0.8,5.3);
  \coordinate (C) at (1.75,5.55);
  \coordinate (D) at (1.75,5.05);
  \node at (A) {\textbf{\color{orange}{Error de memoria}}};
  \node at (B) {dijkstra};
  \node at (C) {\textbf{\color{orange}{Error de memoria}}};
  \node at (D) {\textbf{\color{gray}{Error de memoria}}};
\end{tikzpicture}
\caption{Duración en segundos de los procesos en el ambiente distribuido con el total de registros.}
\label{barras:nube-duracion80M}
\end{figure}
\end{center}

\begin{itemize}
	\item \textbf{Robustez.} Con el total de los registros ambos \textit{frameworks} presentaron problemas para la ejecución de algunos de los procesos. En el caso de \textit{Spark} el problema se presentó en el proceso \texttt{dijkstra} y fue provocado por pérdidas constantes de ejecutores debido a falta de recursos. Este mismo problema se presentó en la ejecución de ese proceso usando \textit{Dask}. Sin embargo, aunque ambos presentaron problemas de falta de memoria, el comportamiento de ellos fue distinto. En el caso de \textit{Spark}, los ejecutores eran reiniciados, mientras que en el de \textit{Dask} estos permanecían sin realizar ninguna acción de forma indefinida y desplegando mensajes de error. De cualquier forma, en ninguno de los dos casos se pudo completar el proceso. Por otro lado, en el caso del proceso \texttt{demoras\_ruta\_mktid}, \textit{Dask} presentó problemas de memoria al escribir a \textit{MySQL} que le impidieron completar este proceso. Este problema también se presentó ocasionalmente en el proceso \texttt{demoras\_ruta\_aeropuerto}, por lo que \textit{Dask} logró completar únicamente 74 de las 100 ejecuciones totales (en este caso se eliminaron las dos ejecuciones más rápidas y las dos que más demoraron). Por lo anterior, podemos concluir que \textit{Spark} mostró mayor robustez con este tamaño de muestra aunque no tuvo un resultado perfecto. 
	
	\item \textbf{Variación.} La tabla \ref{table:nube-duracion80M} muestra que durante esta ejecución \textit{Spark} registró un coeficiente de variación menor en todos los casos y además, a excepción del proceso \texttt{demoras\_ruta\_mktid}, este fue menor de 0.05, lo cuál muestra una gran consistencia en la ejecución de las tareas. Por otro lado, si consideramos la desviación estándar podemos ver que en la mayor parte de los casos esta fue menor a 7 segundos y que la diferencia de tiempo entre ambos \textit{frameworks} casi siempre fue menor a 2 segundos. Las excepciones de esto fueron los procesos \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid}. En el primer caso, \textit{Dask} alcanzó un coeficiente de variación de 0.567 debido principalmente a los problemas de memoria que enfrentó, mientras que \textit{Spark} logró mantener la consistencia en la duración. En el caso del segundo proceso, \textit{Spark} alcanzó un coeficiente de variación de 0.492 que se explica por la gran variación que tuvo al escribir a \textit{MySQL}, donde registró una desviación estándar de 401.37 segundos. Considerando lo anterior, podemos ver que ambos procesos alcanzaron niveles altos de consistencia en la ejecución, con \textit{Spark} alcanzando mejores resultados debido a los bajos coeficientes alcanzados y a las desviaciones estándar que fueron menores a 6 segundos la mayoría de las ocasiones.
	
	\item \textbf{Inicio de la ejecución.} En cuánto al inicio de la ejecución, podemos ver en la tabla \ref{table:nube-otros80M} que ésta sigue teniendo la misma dinámica, con \textit{Dask} registrando menores tiempos de inicio con una diferencia menor a 2 segundos respecto al tiempo registrado por \textit{Spark} en todos los casos.
	
	\item \textbf{Escritura.} Al considerar los resultados sobre la escritura presentados en la tabla \ref{table:nube-duracion80M}, podemos notar los siguiente. En primer lugar, \textit{Dask} sigue registrando un escritura más rápida a archivos \texttt{parquet} con la diferencia de que con esta muestra \textit{Spark} registró la menor razón de duración al escribir el menor de los resultados, cuando anteriormente esto se registraba en la escritura del resultado de mayor tamaño. Sin embargo, al escribir el resultado más grande, la razón de duración fue muy cercana a la mencionada anteriormente. En segundo lugar, se sigue apreciando el mejor desempeño de \textit{Spark} al escribir resultados grandes a \textit{MySQL}, donde las razones presentan una menor diferencia entre los \textit{frameworks} que en el caso de escritura a \texttt{parquet}. También es importante mencionar que la escritura a \texttt{parquet} representa menos del 5\% del tiempo total de ejecución de \textit{Dask} en los tres procesos que lo hacen, mientras que en el caso de \textit{Spark} estos se ubican entre 7.1\% y 63.5\%, lo que demuestra una oportunidad de mejora en la escritura a este tipo de archivos. En el caso de \textit{MySQL} la tendencia no es tan clara ya que no tenemos información sobre la escritura de \textit{Dask} a este destino con el resultado de mayor tamaño, pero es importante mencionar que los errores de ejecución de \textit{Dask} se registraron durante la escritura, por lo que podemos suponer un mejor desempeño de \textit{Spark} al escribir a estas bases de datos.
	
	\item \textbf{Capacidad de cómputo.} Regresando a los resultados de la tabla \ref{table:nube-otros80M}, podemos ver que en la mayoría de los casos \textit{Dask} sigue siendo superior a \textit{Spark}, registrando en estos casos duraciones de entre el 32\% y 78\% del tiempo registrado por \textit{Spark}. Sin embargo, en los procesos \texttt{demoras\_ruta\_aeropuerto} y \texttt{flota}, \textit{Spark} calculó el resultado en 18\% y 75.9\% del tiempo que dedicó \textit{Dask} a estos procesos. En el caso del proceso \texttt{demoras\_ruta\_aeropuerto} la tendencia se mantuvo y tiene que ver con el mejor desempeño de \textit{Spark} para operar con una llave creada durante la ejecución, pero en el caso del proceso \texttt{flota}, que consiste en un conteo después de eliminar los duplicados, esta es la primera vez que \textit{Spark} alcanza un tiempo de cómputo menor.
	
	\item \textbf{Duración.} Por último, al observar los datos de la figura \ref{barras:nube-duracion80M}, podemos ver que la diferencia en los tiempos de ejecución se sigue reduciendo respecto a las muestras previas y, además, \textit{Spark} tuvo una menor duración que \textit{Dask} en el proceso \texttt{flota}, lo cuál no había sucedido con muestras más pequeñas y que se explica por el menor tiempo de cómputo. Por otro lado, si observamos la información de la tabla \ref{table:nube-duracion80M}, podemos ver que a excepción del proceso \texttt{demoras\_aeropuerto\_destino}, el tiempo de \textit{Spark} fue mayor en menos de un 163\% y la excepción está en gran medida influenciada por el extenso tiempo de escritura. Además, en los dos procesos que \textit{Spark} alcanzó menores tiempos de ejecución promedio, estos tomaron 47.2\% y 79.1\% del tiempo que \textit{Dask} requirió. No obstante, la diferencia fue mayor en los procesos que \textit{Dask} registró menor duración. En suma, \textit{Dask} fue significativamente más rápido en 4 de los 6 procesos que ambos \textit{frameworks} lograron completar, por lo que considero que su desempeño sigue siendo superior.
	
\end{itemize}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de ejecuciones}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{duración promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{desviación estándar}} & \multicolumn{1}{p{2.5cm}}{\centering \textbf{coeficiente de variación}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (duración)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (duración)}} \\ \hline
        demoras\_aerolinea & dask & 90 & 61.23 & 3.519 & 0.057 & 0.729 & 1.372 \\ % \hline
        demoras\_aerolinea & spark & 90 & 84.014 & 1.934 & 0.023 & 0.729 & 1.372 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 90 & 68.185 & 3.396 & 0.05 & 0.273 & 3.659 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 90 & 249.494 & 4.854 & 0.019 & 0.273 & 3.659 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 90 & 150.533 & 4.652 & 0.031 & 0.614 & 1.628 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 90 & 245.044 & 6.037 & 0.025 & 0.614 & 1.628 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 70 & 615.653 & 348.971 & 0.567 & 2.119 & 0.472 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 90 & 290.496 & 3.823 & 0.013 & 2.119 & 0.472 \\ % \hline
        demoras\_ruta\_mktid & dask & NA & NA & NA & NA & NA & NA \\ % \hline
        demoras\_ruta\_mktid & spark & 90 & 815.236 & 400.972 & 0.492 & NA & NA \\ % \hline
        dijkstra & dask & NA & NA & NA & NA & NA & NA \\ % \hline
        dijkstra & spark & NA & NA & NA & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & 90 & 22.807 & 1.551 & 0.068 & 0.658 & 1.519 \\ % \hline
        elimina\_nulos & spark & 90 & 34.642 & 1.676 & 0.048 & 0.658 & 1.519 \\ % \hline
        flota & dask & 90 & 97.55 & 4.027 & 0.041 & 1.263 & 0.791 \\ % \hline
        flota & spark & 90 & 77.208 & 2.206 & 0.029 & 1.263 & 0.791 \\ \hline
    \end{tabular}}
    \caption{Información sobre la duración total en segundos en el ambiente distribuido con el total de registros.}
    \label{table:nube-duracion80M}
\end{table}


\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de inicio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de cómputo}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{$\frac{\texttt{dask}}{\texttt{spark}}$ (cómputo)}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{$\frac{\texttt{spark}}{\texttt{dask}}$ (cómputo)}} \\ \hline
        demoras\_aerolinea & dask & 0.024 & 60.316 & 1.294 & 0.773 \\ % \hline
        demoras\_aerolinea & spark & 2.35 & 78.051 & 1.294 & 0.773 \\ % \hline
        demoras\_aeropuerto\_destino & dask & 0.024 & 65.402 & 3.028 & 0.33 \\ % \hline
        demoras\_aeropuerto\_destino & spark & 2.332 & 198.025 & 3.028 & 0.33 \\ % \hline
        demoras\_aeropuerto\_origen & dask & 0.024 & 65.98 & 3.041 & 0.329 \\ % \hline
        demoras\_aeropuerto\_origen & spark & 2.386 & 200.656 & 3.041 & 0.329 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & 0.023 & 588.198 & 0.18 & 5.546 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & 2.315 & 106.056 & 0.18 & 5.546 \\ % \hline
        demoras\_ruta\_mktid & dask & NA & NA & NA & NA \\ % \hline
        demoras\_ruta\_mktid & spark & 2.324 & 199.89 & NA & NA \\ % \hline
        dijkstra & dask & NA & NA & NA & NA \\ % \hline
        dijkstra & spark & NA & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & 0.025 & 22.807 & 1.519 & 0.658 \\ % \hline
        elimina\_nulos & spark & 2.37 & 34.642 & 1.519 & 0.658 \\ % \hline
        flota & dask & 0.025 & 93.521 & 0.759 & 1.317 \\ % \hline
        flota & spark & 2.397 & 71.025 & 0.759 & 1.317 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de cómputo e inicio de la ejecución en segundos en el ambiente distribuido con el total de registros.}
    \label{table:nube-otros80M}
\end{table}

\begin{table}
    \centering
    \resizebox{\textwidth}{!}{
    \begin{tabular}{|l|c c c c c|}
    \hline
        \multicolumn{1}{|p{2.2cm}|}{\centering \textbf{proceso}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{framework}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{destino de escritura}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{tiempo de escritura promedio}} & \multicolumn{1}{p{2.2cm}}{\centering \textbf{número de renglones escritos}} & \multicolumn{1}{p{2.2cm}|}{\centering \textbf{número de columnas escritos}} \\ \hline
        demoras\_aerolinea & spark & parquet & 5.963 & 78133 & 11 \\ % \hline
        demoras\_aerolinea & dask & parquet & 0.914 & 78133 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & spark & parquet & 51.469 & 1490152 & 11 \\ % \hline
        demoras\_aeropuerto\_destino & dask & parquet & 2.783 & 1490152 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & spark & mysql & 44.388 & 1490410 & 11 \\ % \hline
        demoras\_aeropuerto\_origen & dask & mysql & 84.553 & 1490410 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & spark & parquet & 184.44 & 19897358 & 11 \\ % \hline
        demoras\_ruta\_aeropuerto & dask & parquet & 27.455 & 19897358 & 11 \\ % \hline
        demoras\_ruta\_mktid & dask & NA & NA & NA & NA \\ % \hline
        demoras\_ruta\_mktid & spark & mysql & 615.346 & 15378534 & 11 \\ % \hline
        dijkstra & dask & NA & NA & NA & NA \\ % \hline
        dijkstra & spark & NA & NA & NA & NA \\ % \hline
        elimina\_nulos & spark & sin escritura & NA & NA & NA \\ % \hline
        elimina\_nulos & dask & sin escritura & NA & NA & NA \\ % \hline
        flota & spark & mysql & 6.183 & 78133 & 6 \\ % \hline
        flota & dask & mysql & 4.029 & 78133 & 6 \\ \hline
    \end{tabular}}
    \caption{Información sobre tiempo de escritura en segundos y tamaño del resultado en el ambiente distribuido con el total de registros.}
    \label{table:nube-write80M}
\end{table}

En conclusión, las ejecuciones con el total de los datos muestran la superioridad de \textit{Spark} en los siguientes tres rubros. Primero la robustez, ya que logró ejecutar sin incidentes dos procesos en los que \textit{Dask} presentó problemas, aunque su desempeño no fue perfecto ya que ninguno de los dos \textit{frameworks} logró ejecutar el proceso \texttt{dijsktra}; segundo, la variación, en la que registró menores coeficientes de variación que \textit{Dask} y obtuvo desviaciones estándar menores a 7 segundos en todos los casos con algunas excepciones, mientras que \textit{Dask} presentó una gran variación en un proceso en el que la de \textit{Spark} fue mínima, y tercero, en la escritura a \textit{MySQL} que no sólo fue más rápida para resultados grandes, sino que fue más estable que la de \textit{Dask}. Por otra parte, \textit{Dask} mantuvo la superioridad en cuatro aspectos. En primer lugar la escritura a \texttt{parquet} que sigue haciendo de manera más rápida; segundo, la capacidad de cómputo en la que es más rápido para calcular el resultado en la mayoría de los procesos y mantiene márgenes grandes respecto a \textit{Spark}; en tercer lugar, el inicio de la ejecución sigue siendo más rápido siempre aunque la diferencia se ha mantenido respecto a muestras anteriores, y en último lugar, sigue teniendo una ejecución total más rápida explicada principalmente por el cómputo más rápido del resultado y la notoria ventaja en la escritura a \texttt{parquet}.



\subsection{Cambio del desempeño entre muestras en el ambiente distribuido}

Una vez finalizado el análisis de cada muestra, vale la pena analizar la evolución de cada \textit{framework} al cambiar el tamaño de la muestra en los distintos procesos. En esta sección se analizará principalmente el tiempo que cada herramienta dedica a la escritura y el tiempo total de ejecución. Al igual que en la sección \ref{subsection:cambio-muestras-local} iniciaré con una revisión de cada proceso individual y después se obtendrán conclusiones generales sobre cada \textit{framework}.

\subsubsection{Proceso de cálculo de flota}

El proceso \texttt{flota} se compone de la eliminación de registros duplicados en una columna y su posterior conteo agrupando por distintas columnas con valores de tiempo, escribiendo el resultado a \textit{MySQL}.

La figura \ref{lineas:nube-flota} muestra una tendencia similar entre ambos \textit{frameworks} durante las primeras tres iteraciones, manteniendo una diferencia de aproximadamente 30 segundos. Sin embargo, al superar los 10 millones de registros esta diferencia se reduce aún más debido a una mejora en el desempeño de \textit{Spark}, el cual aumenta el tiempo de ejecución en menos de 2 segundos a pesar de que el número de registros es más de 10 veces mayor. En el caso de \textit{Dask}, pasar de 1 a 11 millones de registros implica un incremento de tiempo de 5 segundos, lo cuál también es muy razonable. No obstante, en el procesamiento del total de datos podemos observar que \textit{Dask} tiene un incremento significativo en el tiempo de procesamiento. Por otro lado, la figura \ref{lineas:nube-flota-write} muestra que aunque el incremento es mayor en el tiempo de escritura en \textit{Dask}, en el caso de \textit{Spark} este es muy similar sin importar el número de registros. Sin embargo, el hecho de que en ambos casos sea menor a 7 segundos muestra que la escritura realmente no fue un factor decisivo ya que las diferencias observadas en las distintas muestras en los tiempos de ejecución totales entre ambos \textit{frameworks} siempre superan los 7 segundos. Por lo tanto, podemos concluir que \textit{Spark} tiene una mayor capacidad de escalamiento ya que sus tiempos de ejecución total y de escritura no cambian mucho con el aumento del número de registros. Por el contrario, en el caso de \textit{Dask} el incremento en el tiempo de escritura es más evidente y también podemos apreciar que, al pasar al procesamiento del total de registros, su desempeño no se logra mantener, ya que registra tiempos más de cinco veces mayores que los observados en la muestra de 11 millones. 



\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 5.261 0.55
      100000 6.205 0.193
      1000000 12.305 0.581
      11000000 17.272 0.6
      80000000 97.55 4.027
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 36.574 1.652
      100000 35.362 0.744
      1000000 40.662 1.601
      11000000 42.84 1.883
      80000000 77.208 2.206
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso flota en diferentes muestras.}
\label{lineas:nube-flota}
\end{figure}


\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.97,0.3)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 0.973 0.096
      49439 2.248 0.082
      76717 3.202 0.155
      78113 3.204 0.171
      78133 4.029 0.846
       
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 5.764 0.331
      49439 5.734 0.311
      76717 6.223 0.355
      78113 5.901 0.275
      78133 6.183 0.34
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso flota en diferentes muestras.}
\label{lineas:nube-flota-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por aerolínea}

Este proceso tiene como operaciones principales conteo de una columna y obtención de promedios de otras cinco, agrupando respecto a distintas columnas de tiempo. El resultado final se almacena en un archivo \texttt{parquet}.

La figura \ref{lineas:nube-demoras-aerolinea} muestra que ambas herramientas tienen un comportamiento similar en este registro y reaccionan de forma parecida a los cambios en el número de registros. Sin embargo, \textit{Dask} registra tiempos aproximadamente 25 segundos inferiores a los de \textit{Spark} durante todas las muestras. Es especialmente interesante que sin importar el número de registros, la diferencia de tiempo es constante. Además, la diferencia de duración entre la primera y la cuarta muestra es menor a 9 segundos en ambos \textit{frameworks} a pesar de que el número de registros es más de 1000 veces mayor. Adicional a lo anterior, podemos ver que aunque la tendencia se rompe al llegar a la ejecución con el total de registros, ambas herramientas mantienen una relación similar, con \textit{Dask} logrando ejecuciones más rápidas. En este caso, podemos ver que aunque ambas herramientas logran mantener su desempeño cuando el número de datos incrementa, la superioridad de \textit{Dask} es clara.

Centrándonos en el proceso de escritura mostrado en la figura \ref{lineas:local-demoras-aerolinea-write}, podemos ver que el cambio en el tiempo de escritura de \textit{Dask} a \texttt{parquet} es mínimo a través de los distintos tamaños de conjuntos de datos. Mientras tanto, \textit{Spark} sufre algunos cambios menores pero en general parece mantenerse constante. De cualquier forma, ambos \textit{frameworks} tienen un tiempo de escritura a \textit{parquet} muy corto y la proporción del tiempo total de ejecución que significan se reduce conforme crece el tamaño de los datos iniciales, por lo que la escritura no parece jugar un papel importante en la dinámica descrita en el párrafo anterior. No obstante, si podemos ver que \textit{Dask} es mucho más eficiente en la escritura a archivos \texttt{parquet}.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 4.782 0.529
      100000 4.388 0.304
      1000000 7.515 0.536
      11000000 12.453 0.584
      80000000 61.23 3.519
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 32.222 1.592
      100000 29.759 0.596
      1000000 35.17 1.701
      11000000 36.27 1.811
      80000000 84.014 1.934
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_aerolinea en diferentes muestras.}
\label{lineas:nube-demoras-aerolinea}
\end{figure}



\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 0.406 0.196
      49439 0.419 0.183
      76717 0.41 0.147
      78113 0.521 0.246
      78133 0.914 0.806
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      12135 4.207 0.844
      49439 3.714 0.223
      76717 4.112 0.287
      78113 4.983 0.281
      78133 5.963 0.244
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de escritura de resultados del proceso demoras\_aerolinea en diferentes muestras.}
\label{lineas:nube-demoras-aerolinea-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por aeropuerto de destino}

El siguiente proceso tiene como operaciones principales el conteo en una columna y la obtención del mínimo de otras cinco, agrupando de acuerdo a distintos periodos de tiempo representados en diversas columnas. El resultado del proceso se escribe en un archivo \texttt{parquet}.

Similar a casos anteriores, durante las ejecuciones en las cuatro muestras de menor tamaño, el tiempo de ejecución de ambos \textit{frameworks} tiene una diferencia casi constante (cercana a 28 segundos) y una tendencia similar conforme cambia el tamaño de la muestra. Además, \textit{Dask} alcanza tiempos de ejecución menores consistentemente, lo cual es aún más evidente al pasar a la ejecución con más de 80 millones de datos, donde el tiempo requerido por \textit{Spark} es 265\% superior. Esto se puede ver en la figura \ref{lineas:nube-demoras-aeropuerto-destino}. Al observar la figura representada en \ref{lineas:nube-demoras-aeropuerto-destino-write} podemos obtener información que ayuda a explicar la figura con las duraciones totales, ya que se puede observar cómo el tiempo de escritura de \textit{Spark} aumenta significativamente con el total de los datos. Sin embargo, esto sólo explica una parte de la diferencia, por lo que la capacidad de \textit{Dask} de cómputo también juega un papel importante en la diferencia que observamos en los tiempos de ejecución.

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 4.713 0.491
      100000 4.52 0.321
      1000000 8.209 0.592
      11000000 14.204 0.513
      80000000 68.185 3.396
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 31.762 1.582
      100000 29.403 0.561
      1000000 36.137 1.671
      11000000 42.881 1.817
      80000000 249.494 4.854
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_aeropuerto\_destino en diferentes muestras.}
\label{lineas:nube-demoras-aeropuerto-destino}
\end{figure}

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22144 0.448 0.207
      116746 0.633 0.278
      436411 0.928 0.231
      1042066 1.685 0.239
      1490152 2.783 1.057
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22144 4.079 0.807
	  116746 3.72 0.216
	  436411 5.348 0.312
	  1042066 10.702 0.289
	  1490152 51.469 0.998
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_aeropuerto\_destino en diferentes muestras.}
\label{lineas:nube-demoras-aeropuerto-destino-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por aeropuerto de origen}

Este proceso tiene como operaciones principales el conteo en una columna y la obtención del máximo de otras cinco, agrupando de acuerdo a distintos periodos de tiempo representados en diversas columnas. El resultado del proceso se escribe a una base de datos \textit{MySQL}.

Algo interesante de este proceso es que a pesar de ser similar al anterior, la figura de duración total (\ref{lineas:nube-demoras-aeropuerto-origen}) es muy distinta sobre todo por qué la diferencia de tiempo entre \textit{Dask} y \textit{Spark} se reduce conforme aumenta el tamaño de la muestra procesada (a excepción de la última). Este comportamiento se puede entender mejor al observar la figura del tiempo de escritura presentada en \ref{lineas:nube-demoras-aeropuerto-origen-write}, donde se observa que el tiempo de escritura incrementa en ambos casos, con \textit{Dask} teniendo una mayor pendiente. Debido a este incremento, la diferencia de tiempo se reduce en las primeras muestras. No obstante, al llegar a las ejecuciones con el total de los datos, el tiempo de cálculo del resultado vuelve a ser un factor y el mejor desempeño de \textit{Spark} en la escritura a \textit{MySQL} pierde importancia, por lo que \textit{Spark} una vez más tiene un tiempo de ejecución mayor que el de \textit{Dask}.


\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 6.085 0.478
      100000 10.849 0.321
      1000000 32.697 1.101
      11000000 70.983 2.942
      80000000 150.533 4.652
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 35.356 1.527
      100000 33.167 0.56
      1000000 45.969 2.322
      11000000 65.451 4.296
      80000000 245.044 6.037
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_aeropuerto\_origen en diferentes muestras.}
\label{lineas:nube-demoras-aeropuerto-origen}
\end{figure}

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22086 1.767 0.141
      116656 6.91 0.154
      436681 25.445 1.078
      1041665 58.308 2.808
      1490410 84.553 2.915
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      22086 7.525 0.328
	  116656 7.757 0.299
	  436681 15.167 1.658
	  1041665 33.062 4.12
	  1490410 44.388 4.769
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_aeropuerto\_origen en diferentes muestras.}
\label{lineas:nube-demoras-aeropuerto-origen-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por ruta entre aeropuertos}

El proceso \texttt{demoras\_ruta\_aeropuertos} tiene como operaciones principales las siguientes: la creación de una nueva llave a partir de la concatenación de dos columnas existentes, un conteo en una columna y cálculo del promedio en otras cinco. Esto lo hace agrupando de acuerdo a la nueva llave y a otras columnas que describen periodos de tiempo. El resultado final se escribe a un archivo \texttt{parquet}.

La figura \ref{lineas:nube-demoras-ruta-aeropuerto}
muestra que, como antes, la diferencia de tiempo de ejecución entre \textit{Dask} y \textit{Spark} es constante. Sin embargo, al llegar a la muestra de 11 millones de datos la diferencia en el tiempo de ejecución de las herramientas es menor a un segundo (con \textit{Dask} manteniendo el menor tiempo) y es en este punto donde la tendencia se invierte y \textit{Spark} termina ejecutando el proceso sobre el total de los datos de forma más rápida. A diferencia de otros procesos, en este caso la escritura no juega un papel importante en el mejor desempeño de \textit{Spark} en el tiempo total. De hecho, como se puede ver en la figura \ref{lineas:nube-demoras-ruta-aeropuerto-write}, el tiempo de escritura de \textit{Spark} a \texttt{parquet} incrementa más que el de \textit{Dask} conforme crecen los datos. Esto muestra que una mejora en la escritura de \textit{Spark} podría llevar a un mejor desempeño que el de \textit{Dask} incluso en las muestras de menor tamaño. Sin embargo, el hecho de que el tiempo de escritura sea más grande en \textit{Spark} que \textit{Dask}, muestra que la superioridad de \textit{Spark} viene de su mayor capacidad para generar la nueva llave y usarla para las agregaciones. Por último, es importante notar la variación de tiempo que presenta  \textit{Dask} en la ejecución de este proceso (la desviación estándar está representada como barras de error) en la ejecución con el total de los datos debido a la inestabilidad que sufrió por falta de memoria que fue lo que le impidió terminar el 100\% de las ejecuciones. 

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 6.278 0.549
      100000 7.721 0.492
      1000000 24.123 2.082
      11000000 93.219 3.162
      80000000 615.653 348.971
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 32.32 1.668
      100000 31.396 0.57
      1000000 46.432 1.655
      11000000 94.119 2.193
      80000000 290.496 3.823
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso demoras\_ruta\_aeropuerto en diferentes muestras.}
\label{lineas:nube-demoras-ruta-aeropuerto}
\end{figure}

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
	41147 0.355 0.124     
	297814 1.147 0.417    
	1619826 2.773 0.285   
	8361958 11.457 0.22   
	19897358 27.455 1.087
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      41147 4.395 0.894     
      297814 5.102 0.233    
      1619826 12.696 0.368  
      8361958 58.22 0.907   
      19897358 184.44 2.79  
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_ruta\_aeropuerto en diferentes muestras.}
\label{lineas:nube-demoras-ruta-aeropuerto-write}
\end{figure}

\subsubsection{Proceso de cálculo de demoras por ruta entre ciudades}

Este proceso es similar al anterior y tiene como operaciones principales las siguientes: la creación de una nueva llave a partir de la concatenación de dos columnas existentes, un conteo en una columna y el cálculo de la desviación estándar en otras 5. Esto lo hace agrupando de acuerdo a la nueva llave y a otras columnas que describen periodos de tiempo. El resultado final se escribe a una base de datos \textit{MySQL}.

Si nos fijamos en la figura \ref{lineas:nube-demoras-ruta-mktid} podemos ver que la diferencia del tiempo de ejecución de ambos \textit{frameworks} no es muy significativa en las primeras ejecuciones. De hecho, este es el primer proceso en el que \textit{Spark} registra un tiempo de ejecución menor desde la muestra de 1 millón de datos. Para explicar esto nos podemos apoyar en la figura \ref{lineas:nube-demoras-ruta-mktid-write} en la que observamos que el tiempo de escritura de \textit{Spark} es menor que el de \textit{Dask} desde la segunda muestra de datos y también el incremento que refleja al incrementar la muestra es menor, lo que ayuda a que \textit{Spark} tenga un tiempo de escritura inferior. No obstante, esto no es suficiente para explicar la diferencia de tiempo, por lo que el tiempo que tarda \textit{Spark} en el cálculo del resultado también juega un papel importante en el mejor desempeño. Esto apoya la conclusión del proceso anterior sobre que \textit{Spark} es mejor que \textit{Dask} para operar sobre una llave creada durante la ejecución del proceso. Finalmente, es importante considerar que \textit{Dask} no fue capaz de finalizar ninguna de las ejecuciones con la muestra de 80 millones, lo que muestra que \textit{Spark} tiene mayor robustez.


\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 9.438 0.571   
      100000 22.635 0.709  
      1000000 102.73 2.755  
      11000000 488.529 22.185
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 6.523 1.875   
      100000 37.79 0.769    
      1000000 91.062 7.062   
      11000000 284.435 165.896
      80000000 815.236 400.972
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio del proceso demoras\_ruta\_mktid en diferentes muestras.}
\label{lineas:nube-demoras-ruta-mktid}
\end{figure}


\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros,
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	% xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[dashed, orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      38909 2.733 0.187     
      267505 15.401 0.585   
      1430282 81.822 1.742  
      6824834 389.748 11.839
    };
    
  \addplot+[dashed, gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      38909 7.772 0.355      
      267505 10.409 0.556    
      1430282 51.365 6.765   
      6824834 238.808 164.908
      15378534 615.346 401.37
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos de la escritura de resultados del proceso demoras\_ruta\_mktid en diferentes muestras.}
\label{lineas:nube-demoras-ruta-mktid-write}
\end{figure}

\subsubsection{Proceso de eliminación de valores nulos}

Ahora pasamos a un proceso que tiene como operaciones principales la eliminación de valores nulos y el conteo de registros resultantes. Debido a que sólo escribe el resultado a consola, el tiempo de escritura no fue considerado.

Los resultados de ejecución de este proceso están representados por la figura \ref{lineas:nube-elimina-nulos}. Al igual que en la ejecución local, este proceso fue el que registró menor duración en todas las muestras, con \textit{Dask} teniendo un desempeño superior y manteniendo una ventaja cercana a 20 segundos durante las primeras cuatro muestras. Algo especialmente interesante de este proceso es que el máximo tiempo promedio registrado por \textit{Dask} (cuando procesa el total de los registros) es inferior que el mínimo registrado por \textit{Spark} (en la muestra de 100 mil registros), lo cual evidencia la velocidad que tiene para completar los registros. No obstante, hay que notar que el incremento de tiempo de \textit{Dask} entre las dos muestras de mayor tamaño es mucho más pronunciado que el registrado por \textit{Spark}, lo que puede sugerir que \textit{Spark} superará el desempeño de \textit{Dask} cuando los datos sigan aumentando. 

\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=6cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 3.815 0.341
      100000 3.163 0.122
      1000000 4.582 0.497
      11000000 6.357 0.57
      80000000 22.807 1.551
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 25.113 1.208
      100000 22.884 0.436
      1000000 26.031 1.4
      11000000 26.382 1.425
      80000000 34.642 1.676
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso elimina\_nulos en diferentes muestras.}
\label{lineas:nube-elimina-nulos}
\end{figure}

\subsubsection{Proceso de obtención de ruta mínima mediante el algoritmo \textit{Dijkstra}}

El último proceso tiene múltiples operaciones como: conteos, filtrados, ordenamientos, etc. Estos se combinan en un algoritmo iterativo que ayuda a evaluar las distintas operaciones y capacidades de los \textit{frameworks} como: almacenamiento temporal de resultados intermedios, creación de nuevos \textit{DataFrames} y manejo de memoria. El resultado de este algoritmo varía de acuerdo a la ruta calculada en el algoritmo, por lo que el tiempo de escritura no fue considerado.

La figura \ref{lineas:nube-dijkstra} muestra una diferencia de tiempo importante entre ambos \textit{frameworks} que se incrementa conforme aumenta el tamaño de los datos. También se puede apreciar un incremento importante en el nivel de variación de \textit{Spark} y un incremento más pronunciado de \textit{Dask} en las últimas muestras. En este caso, durante todas las muestras, \textit{Dask} tuvo una clara ventaja en el tiempo de ejecución que se incrementó en las últimas dos, probablemente influenciado por las grandes cantidades de datos que \textit{Spark} tuvo que escribir en disco y que \textit{Dask} fue capaz de mantener en memoria. Además, es importante notar que la variación de \textit{Dask} es casi nula comparada con la de \textit{Spark}, a pesar de que hayan ejecutado las mismas rutas. Por último, no hay que olvidar que las tres ejecuciones más largas de \textit{Spark} fueron interrumpidas debido a que excedieron una hora, por lo que la diferencia en la última muestra es aún mayor de lo que los datos revelan. En este proceso sin duda \textit{Dask} fue superior.


\begin{figure}
\centering
\begin{tikzpicture}[trim axis left, trim axis right]
\begin{axis}[
	xlabel = Número de registros (log),
	ylabel = Duración en segundos,
	legend style={at={(0.45,0.95)}},
	xmode=log,
	% ymode=log,
	width=12cm,
	height=10cm
	]
  \addplot+[orange,mark options={fill=orange},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 6.676 3.149
      100000 9.692 2.618
      1000000 56.549 8.287
      11000000 225.863 40.147
      % 80000000 NA NA
    };
    
  \addplot+[gray,mark options={fill=gray},error bars/.cd,y dir=both,y explicit] 
    table[x=x,y=y,y error=error] {
      x   y   error
      10000 124.251 97.16
      100000 111.238 105.217
      1000000 487.518 807.132
      11000000 600.708 1062.603
      % 80000000 NA NA
    };
    \legend {Dask, Spark}
\end{axis}
\end{tikzpicture}
\caption{Duración promedio en segundos del proceso dijkstra en diferentes muestras.}
\label{lineas:nube-dijkstra}
\end{figure}

\subsection{Conclusiones generales sobre las ejecuciones en el ambiente distribuido}

Una vez realizadas las pruebas en el ambiente distribuido, podemos resumir las conclusiones más importantes en los siguientes puntos:

\begin{itemize}
	
	\item \textbf{Robustez.} Al pasar al ambiente distribuido, ambas herramientas lograron ejecutar el 100\% de las ejecuciones en las tres primeras muestras de datos. Sin embargo, al llegar a 11 millones de registros \textit{Dask} presentó problemas de memoria debido a un mal manejo del \texttt{cache}. No obstante, reiniciar eventualmente los \texttt{dask-workers} resolvió el problema y permitió a \textit{Dask} completar el 100\% de sus ejecuciones, mientras que \textit{Spark} logró hacerlo sin ninguna intervención. Por otra parte, en la ejecución utilizando el total de los datos, \textit{Spark} logró ejecutar sin problema todas las ejecuciones aunque en el caso de \texttt{dijkstra} algunas fueron interrumpidas debido a que su tiempo de ejecución excedió 1 hora. Sin embargo no presentó errores que sugirieran que la ejecución presentaría problemas. Por otro lado, \textit{Dask} registró problemas en la ejecución del procesos \texttt{demoras\_ruta\_aeropuerto} y \texttt{demoras\_ruta\_mktid}, donde en el primer caso, logró completar el 74\% de las ejecuciones totales (aunque requirió de un monitoreo constante igual que en la muestra anterior) y en caso del segundo proceso, no logró completar ninguna de las ejecuciones. Adicionalmente, ninguno de los dos \textit{frameworks} logró ejecutar el proceso \texttt{dijkstra} con el total de los datos debido a falta de recursos. Por último, ambos \textit{frameworks} lograron ejecutar sin problemas el resto de los procesos, sin embargo, \textit{Dask} presentó problemas más importantes en la ejecución y \textit{Spark} requirió menos intervención para completar los procesos por lo que considero que fue más confiable para la ejecución de los procesos.
	
	\item \textbf{Variación.} Durante las primeras tres muestras de datos, el comportamiento de los \textit{frameworks} es más o menos consistente, con \textit{Spark} registrando menores coeficientes de variación pero con \textit{Dask} obteniendo desviaciones estándar menores. Otro factor que influye en esto, es que los tiempos de ejecución de \textit{Dask} son mucho menores, por lo que considero que este es el \textit{framework} que más consistencia muestra. Pasando a la muestra de 11 millones de datos, podemos ver una clara consistencia de \textit{Dask}, ya que registró coeficientes de variación y desviaciones estándar menores en todos la mayor parte de los procesos. Sin embargo, este comportamiento cambió al alcanzar las ejecuciones con el total de los registros, ya que \textit{Spark} registró coeficientes menores en las ejecuciones aunque no siempre obtuvo desviaciones estándar menores. No obstante, en ambas herramientas la desviación estándar registrada por los procesos fue menor a 6 segundos y con un coeficiente menor a 0.07 en la mayoría de los casos, por lo que ambos registraron variaciones pequeñas la mayor parte del tiempo. Adicional a esto, cabe destacar que en ambos casos la desviación estándar más grande registrada fue en el proceso \texttt{dijkstra} donde \textit{Spark} obtuvo variaciones mucho mayores influenciadas en gran medida por sus duraciones más largas. Tomando en cuenta lo anterior, considero que \textit{Dask} tuvo mayor consistencia en la duración de la ejecución, ya que obtuvo desviaciones estándar menores en la mayoría de los casos y además registró variaciones significativamente menores en el proceso iterativo.
	
	\item \textbf{Inicio de la ejecución.} El comportamiento de los \textit{frameworks} se mantuvo constante durante las diferentes muestras, con ambos registrando tiempos casi constantes del inicio de la ejecución a través de ellas y con \textit{Dask} teniendo tiempos de inicio entre 2 y 3 segundos menores a los de \textit{Spark} la mayoría de las veces, por lo que considero que \textit{Dask} fue superior en este aspecto.
	
	\item \textbf{Escritura.} En este rubro, los resultados mostraron que \textit{Dask} fue consistentemente más rápido en la escritura a archivos \texttt{parquet}, dónde su tiempo de escritura tuvo muy pequeños incrementos a pesar de escribir cantidades mayores de datos. En el caso de \textit{Spark}, el incremento de tiempo proporcional a los registros escritos fue mayor que el de \textit{Dask}, lo cuál se convirtió en una desventaja importante para \textit{Spark}. En este caso, el tiempo de escritura de \textit{Spark} significó una gran proporción del tiempo total e incluso provocó que  en algunos casos registrara tiempos globales mayores a pesar de tener tiempos de cómputo inferiores a los de \textit{Dask}. Por otra parte, en el caso de la escritura a \textit{MySQL}, \textit{Spark} realizó la escritura en menos del 70\% del tiempo registrado por \textit{Dask} cuando el resultado escrito fue de 436,681 registros o superior, mientras que \textit{Dask} alcanzó tiempos de escritura inferiores (menos del 90\% del tiempo registrado por \textit{Spark}) cuando el número de registros fue menor o igual a 116,656. Sin embargo, en la mayoría de los casos, cuando el resultado fue menor a 116,656 registros, el tiempo dedicado a la escritura fue menos del 30\% del total, mientras que con resultados más grandes, esta proporción aumentó al 50\% y llegó hasta más del 75\% del tiempo en muchos de los procesos, por lo que creo que la capacidad de \textit{Spark} de escritura a \textit{MySQL} es mejor a pesar de que haya sido más lento en la escritura de resultados de menor tamaño. También es importante recalcar que los tiempos de escritura a \texttt{parquet} fueron significativamente menores que los de \textit{MySQL} con ambas herramientas. En suma, considero que \textit{Dask} fue muy superior en la escritura a \texttt{parquet}, pero que \textit{Spark} lo fue a \textit{MySQL} cuando los conjuntos de datos a escribir eran muy grandes. Además, es importante mencionar que aunque en muchas ocasiones una de las herramientas superó a la otra en el cálculo del resultado, el destino de escritura compensaba el tiempo, por lo que en ambos casos existen áreas de oportunidad para mejorar los procesos de escritura y así volverse más competitivas ya que alcanzarán tiempos globales menores. 
		
	\item \textbf{Capacidad de cómputo.} En el ambiente distribuido, \textit{Dask} mostró una mayor velocidad en el cálculo de operaciones de agregación como máximo y mínimo. En procesos con estas operaciones registró tiempos inferiores al 40\% del tiempo registrado por \textit{Spark}. Por otro lado, para cálculo de promedios con una llave dada, \textit{Dask} también registró tiempos promedio de entre aproximadamente 15\% (en muestras de 10K y 100K) y 78\% (usando el total de los datos) de lo registrado por \textit{Spark}. Sin embargo, conforme aumentaba el número de registros la brecha de tiempo entre ambas herramientas se iba cerrando, por lo que si la tendencia continúa de esa manera, \textit{Spark} alcanzará el desempeño de \textit{Dask}. Esto sucedió en el caso del proceso \texttt{flota}, en el que \textit{Spark} pasó de ser un 618\% más tardado que \textit{Dask} en la primera muestra hasta requerir solo un 75.9\% del tiempo que \textit{Dask} tardó. En el caso del otro proceso de preparación de datos (\texttt{elimina\_nulos}), \textit{Dask} siempre fue más rápido, pero la tendencia también muestra que la diferencia entre ambos \textit{frameworks} se reduce conforme crecen los datos. Pasando a los procesos que requieren la creación de una nueva llave para realizar las operaciones, se ve una tendencia similar. En las primeras muestras \textit{Dask} es mucho más rápido en el cálculo del proceso, pero es superado por \textit{Spark}, que logra ejecutar los procesos con las muestras superiores a 1 millón en menos de la mitad del tiempo que \textit{Dask}. Por último, pasando al proceso \texttt{dijkstra}, \textit{Dask} sin duda fue superior gracias a su mejor manejo de memoria, registrando tiempos de máximo un tercio de los registrados por \textit{Spark}. Aunque, una vez más, la diferencia de tiempo se redujo con cada ejecución. En conclusión, con estas muestras de datos \textit{Dask} obtuvo mejores resultados en general, aunque \textit{Spark} fue muy superior en procesos que involucraron la creación de una nueva llave. No obstante, también una constante durante las ejecuciones fue una reducción de la brecha de tiempo entre ambos \textit{frameworks}, por lo que \textit{Spark} parece volverse cada vez más competitivo conforme crece el conjunto de datos, por lo que sería interesante probar con un conjunto de datos más grande para ver si \textit{Spark} supera a \textit{Dask} o si la brecha se mantiene.
	
	\item \textbf{Duración.} Durante las distintas muestras, \textit{Dask} registró tiempos de ejecución menores en la mayoría de los procesos, y en muchos de los casos la diferencia de tiempo con \textit{Spark} fue considerable. Sin embargo, algo que también sucedió a través de los distintos procesos fue que la brecha entre los \textit{frameworks} se redujo conforme el tamaño de las muestras aumentó. Esto se debió en primer lugar a la mejora del tiempo de cómputo de \textit{Spark} pero también a la escritura, ya que el tiempo de escritura a \textit{MySQL} aumentó considerablemente en el caso de \textit{Dask}, mientras que para \textit{Spark} la escritura a \texttt{parquet} no sufrió un incremento tan pronunciado. Por esta razón, la ventaja que tenía \textit{Dask} en la escritura a este tipo de archivos se redujo mientras que la ventaja de \textit{Spark} en la escritura a \textit{MySQL} aumentó. Otro comportamiento interesante fue que durante las primeras cuatro muestras, el incremento de tiempo de \textit{Spark} fue mayor que el de \textit{Dask}, y tiempos de entre 20 y 30 segundos de diferencia entre los \textit{frameworks} fueron algo constante, lo cuál sugiere que existe algún tipo de operación que produce un \textit{overhead} que existe en \textit{Spark} pero no en \textit{Dask} y que le da una ventaja inicial al segundo pero que puede perder importancia conforme aumenta la duración de los procesos como fue el caso de los procesos que implican la creación de una nueva llave. Considerando lo anterior, creo que \textit{Dask} ofrece mayor rapidez en la ejecución de la mayor parte de los procesos, especialmente con muestras más pequeñas, y también tiene resultados muy razonables cuando estos son inferiores a \textit{Spark}, ya que rara vez registró tiempos de más del doble de los de \textit{Spark} y muchas veces registró tiempos por debajo de la mitad de duración. Sin embargo, también creo que la tendencia sugiere que \textit{Spark} se volverá cada vez más competitivo frente a \textit{Dask}, por lo que creo que en el futuro valdrá la pena evaluar los resultados de ambos \textit{frameworks} con un conjunto de datos de mayor tamaño. No obstante, sobre todo en los procesos de agregaciones como máximos y mínimos, promedios y el de eliminación de valores nulos, \textit{Dask} aún tiene una ventaja considerable, por lo que creo que puede mantener tiempos inferiores en muestras de mayor tamaño.
	
\end{itemize}